---
name: xlsx
description: Excelスプレッドシート(.xlsx)の読み取り、作成、編集を行うスキル。数式、チャート、データ変換に対応。
source: https://github.com/anthropics/skills/tree/main/skills/xlsx
---

## 目的

Excelスプレッドシート(.xlsx, .xlsm, .csv, .tsv)の包括的な操作を行う。数式、フォーマット、財務モデル作成まで対応。

---

## トリガー語

- 「Excelを作成」
- 「スプレッドシートを編集」
- 「xlsxで計算」
- 「財務モデルを作成」

---

## コア要件

### エラーゼロ

すべての成果物で数式エラーを排除：
- #REF!
- #DIV/0!
- #VALUE!
- #N/A
- #NAME?

### テンプレート維持

既存ファイル編集時は確立されたフォーマットと慣例に合わせる

---

## 財務モデル標準

### 色コーディング

| 色 | 用途 |
|----|------|
| 青テキスト | ユーザー入力・変更可能数値 |
| 黒テキスト | 数式・計算 |
| 緑テキスト | 内部ワークシートリンク |
| 赤テキスト | 外部ファイルリンク |
| 黄背景 | 要注意の主要仮定 |

### 数値フォーマット

- 年: テキスト形式（"2024"、"2,024"ではない）
- 通貨: $#,##0形式 + 単位ヘッダー
- ゼロ: "-"で表示
- パーセント: 0.0%形式
- 負数: 括弧で囲む

---

## 重要実装ルール

### 数式を使用（ハードコード禁止）

Pythonで計算して埋め込むのではなく、Excel数式（=SUM(), =AVERAGE()等）を常に使用。スプレッドシートの動的性を維持。

### 数式ドキュメント

ハードコード値には引用が必要：
- ソース
- 日付
- 具体的参照
- URL（該当する場合）

### 仮定の配置

すべての仮定を専用セルに分離し、数式から参照

---

## ツール＆ワークフロー

| ツール | 用途 |
|--------|------|
| pandas | データ分析・一括操作 |
| openpyxl | 数式・フォーマット・Excel固有機能 |
| recalc.py | 数式再計算（作成/修正後に必須） |

**注意**: recalc.pyにはLibreOfficeのインストールが必要

---

## ライセンス

Anthropic Skills Repository License（LICENSE.txt参照）
