---
marp: true
theme: default
paginate: true
header: "AIポリテラシー育成プログラム"
footer: "Session 8-2: メタプロンプトで知識ベース生成（実践編）"
style: |
  section {
    font-family: 'Noto Sans JP', 'Hiragino Sans', sans-serif;
  }
  h1 {
    color: #2563eb;
  }
  h2 {
    color: #1e40af;
  }
  .highlight {
    background: linear-gradient(transparent 60%, #fef08a 60%);
  }
  .point {
    background-color: #dbeafe;
    padding: 1rem;
    border-radius: 8px;
  }
  table {
    font-size: 0.9em;
  }
---

<!-- _class: lead -->
# Session 8-2
## メタプロンプトで知識ベース生成（実践編）

**AIポリテラシー育成プログラム**
Week 8 / Phase 3

---

# Session 8 全体構成

| パート | 内容 | 実習 |
|---|---|---|
| 8-1 | 知識ベース設計の原則（理論） | EX-15 |
| **8-2（本動画）** | メタプロンプトで知識ベース生成（実践） | EX-16 |

---

# 前回の振り返り（8-1）

### 学んだこと

| 項目 | 内容 |
|---|---|
| **知識ベースとは** | RAGの仕組み、専門知識の付与 |
| **ファイル形式** | Markdown推奨、用途別選択 |
| **チャンク設計** | 自己完結・トピック単位・適切サイズ |
| **検索精度向上** | キーワード・同義語・FAQ形式・メタデータ |
| **幻覚対策** | 範囲明示・Instructions連携 |

---

# 本動画の学習目標

この動画を終えると、以下ができるようになります：

✅ 知識ベース設計メタプロンプトを実行できる

✅ 生成された知識ファイルを評価できる

✅ 改善ループで品質を高められる

---

<!-- _class: lead -->
# Part 1: メタプロンプトの実行準備

---

# 入力の確認

### Session 6-7で作成した成果物

```
準備するもの：

1. GPTs企画書（EX-12）
   - 必要な知識ベース（リスト）
   - 目的・解決する課題
   - 機能概要

2. Instructions（EX-14）
   - 例外処理（幻覚対策）
   - 対話フロー
```

> **チェック**: 両方が手元にあることを確認してから進めてください

---

# 必要な知識ベースの確認

### GPTs企画書から抽出

```markdown
## 5. 必要な知識ベース

| ファイル名 | 内容 | 形式 | 備考 |
|---|---|---|---|
| 商品カタログ.md | 商品情報 | Markdown | 価格・仕様含む |
| FAQ.json | よくある質問 | JSON | Q&A形式 |
| 提案書テンプレート.md | 骨子テンプレート | Markdown | |
| 成功事例集.md | 過去の成功提案 | Markdown | 10件 |
```

> この一覧を詳細設計するのがSession 8の目的

---

# メタプロンプトの準備

### EX-15で作成したメタプロンプト

```markdown
あなたは知識ベース設計のエキスパートです。
以下の情報から知識ベースを設計・生成します。

【Phase 1: 設計ヒアリング】
...

【Phase 2: 知識ファイル生成】
...

【共通DoD（品質基準）】
...
```

> EX-15の成果物を使用します

---

<!-- _class: lead -->
# Part 2: 知識ベース設計メタプロンプト

---

# メタプロンプトの構造

### 3つのフェーズ

```
┌─────────────────────────────────────────────────────┐
│              Phase 1: 設計ヒアリング                 │
│  ・対象GPTsの目的確認                                │
│  ・必要な知識の種類特定                              │
│  ・既存資料の有無確認                                │
└─────────────────────────────────────────────────────┘
                         ↓ OK
┌─────────────────────────────────────────────────────┐
│              Phase 2: 設計書生成                     │
│  ・ファイル一覧と形式決定                            │
│  ・チャンク設計                                       │
│  ・検索最適化方針                                     │
└─────────────────────────────────────────────────────┘
                         ↓ OK
┌─────────────────────────────────────────────────────┐
│              Phase 3: 知識ファイル生成               │
│  ・設計書に基づきファイル生成                        │
│  ・検索最適化の適用                                   │
│  ・幻覚対策の組込                                     │
└─────────────────────────────────────────────────────┘
```

---

# Phase 1: 設計ヒアリング

### 確認する項目

```markdown
【Phase 1: 設計ヒアリング】
以下のサイクルを繰り返してください：
1. まとめ: 入力情報を整理
2. 提案: 知識ベース構成案を提示
3. 質問: 不明点を確認

確認観点:
- 対象GPTsの目的と主要機能
- 必要な知識の種類（マニュアル、FAQ、データ等）
- 既存資料の有無と形式
- 情報の機密区分
- 更新頻度の想定

私が「OK」と言ったらPhase 2に進んでください。
```

---

# Phase 2: 設計書生成

### 出力内容

```markdown
【Phase 2: 設計書生成】
確定要件に基づいて知識ベース設計書を生成してください。

出力形式:
1. ファイル一覧
   - ファイル名、形式、内容、チャンク数目安
2. チャンク設計
   - ID、タイトル、内容概要、サイズ目安
3. 検索最適化方針
   - キーワード戦略
   - 同義語対応
   - FAQ形式の活用
4. 幻覚対策
   - 範囲の明示
   - 含まれない情報の列挙
```

---

# Phase 3: 知識ファイル生成

### 生成のルール

```markdown
【Phase 3: 知識ファイル生成】
設計書に基づいて知識ファイルを生成してください。

生成ルール:
1. 1ファイルずつ順番に生成
2. チャンク設計に沿った構造
3. 検索最適化を適用
4. 幻覚対策を冒頭に配置

私が「次へ」と言ったら次のファイルを生成
私が「完了」と言ったら終了
```

---

# 共通DoD（品質基準）

### 固定の評価基準

```markdown
【共通DoD（品質基準）】
1. 構造品質: チャンク設計に沿っているか
2. 検索最適化: キーワード・同義語が適切か
3. 自己完結性: 各チャンクが単独で意味を成すか
4. 幻覚対策: 範囲が明示されているか
5. 実用性: このまま使える品質か
```

> これらは変数化せず、固定で含める

---

<!-- _class: lead -->
# Part 3: メタプロンプトの実行

---

# 実行の流れ

### 3フェーズの実行

```
Step 1: Phase 1実行
        ・GPTs企画書を入力
        ・設計要件を確認
        ・「OK」で次へ
              ↓
Step 2: Phase 2実行
        ・設計書を生成
        ・内容を確認・修正
        ・「OK」で次へ
              ↓
Step 3: Phase 3実行
        ・知識ファイルを順次生成
        ・「次へ」で次のファイル
        ・「完了」で終了
```

---

# 実行例: Phase 1

### 入力と対話

```
【ユーザー入力】
以下のGPTs企画書に基づいて知識ベースを設計してください。

[GPTs企画書をペースト]

---

【AIの応答】
入力いただいた企画書を整理します。

## まとめ
- GPTs名: 提案書ドラフター Pro
- 目的: 提案書作成時間の50%削減
- 必要な知識: 商品情報、FAQ、テンプレート、成功事例

## 提案
4つのファイルを以下の形式で作成することを提案します...

## 質問
1. 既存の商品カタログはどの形式ですか？
2. FAQは何件程度を想定していますか？
```

---

# 実行例: Phase 2

### 設計書の生成

```
【ユーザー】
OK

---

【AIの応答】
# 知識ベース設計書

## 1. ファイル一覧

| ファイル名 | 形式 | 内容 | チャンク数 |
|---|---|---|---|
| products.md | Markdown | 商品カタログ | 15 |
| faq.json | JSON | よくある質問 | 20 |
| template.md | Markdown | 提案書テンプレート | 5 |
| success_cases.md | Markdown | 成功事例集 | 10 |

## 2. チャンク設計

| ID | タイトル | 内容 | サイズ |
|---|---|---|---|
| PRD-001 | 商品A概要 | 基本情報・価格 | 400字 |
...
```

---

# 実行例: Phase 3

### 知識ファイルの生成

```
【ユーザー】
OK、ファイルを生成してください

---

【AIの応答】
最初のファイル products.md を生成します。

---
category: 商品情報
tags: [商品, カタログ, 価格]
updated: 2025-01-XX
scope: 2025年1月時点の情報
---

# 商品カタログ

本ファイルは当社商品の情報を含みます。

## 含まれる情報
- 商品名・型番
- 定価（税抜）
- 基本仕様

## 含まれない情報（別途確認が必要）
- 在庫状況（リアルタイム変動）
- 法人向け特別価格
...
```

---

# タイムボックス推奨

### 実行時間の目安

| 作業 | 推奨時間 | 上限 | 備考 |
|---|---|---|---|
| Phase 1（ヒアリング） | 10分 | 15分 | 最大3往復 |
| Phase 2（設計書生成） | 15分 | 20分 | 確認・修正含む |
| Phase 3（ファイル生成） | 20分 | 30分 | ファイル数による |
| 評価・修正 | 15分 | 20分 | |
| **合計** | **60分** | **85分** | |

> 85分を超えたら「完了」として振り返りに記録

---

<!-- _class: lead -->
# Part 4: 生成物の評価

---

# 評価の観点

### 5つのチェックポイント

| # | 観点 | 確認内容 |
|---|---|---|
| 1 | **構造品質** | チャンク設計に沿っているか |
| 2 | **検索最適化** | キーワード・同義語が適切か |
| 3 | **自己完結性** | 各チャンクが単独で意味を成すか |
| 4 | **幻覚対策** | 範囲が明示されているか |
| 5 | **実用性** | このまま使える品質か |

---

# 評価1: 構造品質

### チェックリスト

```
✅ ファイル形式は設計書通りか
   - Markdown形式で作成すべきものがMarkdownか
   - JSON形式で作成すべきものがJSONか

✅ チャンク数は設計書の目安に近いか
   - 設計: 15チャンク → 実際: 12-18なら OK

✅ 見出しレベルは適切か
   - H1, H2, H3 が論理的に構成されているか
```

---

# 評価2: 検索最適化

### チェックリスト

```
✅ 主要キーワードが含まれているか
   - 商品名、機能名、専門用語

✅ 同義語・類語が併記されているか
   - 「返品」「キャンセル」「解約」

✅ FAQ形式の見出しがあるか
   - 「〇〇できますか？」「〇〇とは？」

✅ メタデータが付与されているか
   - category, tags, updated
```

---

# 評価3: 自己完結性

### チェックリスト

```
✅ 各チャンクが単独で意味を成すか
   - 「上記の通り」「前述の」などの参照がないか

✅ 必要な文脈が含まれているか
   - 背景情報が省略されていないか

✅ 適切なサイズか
   - 200-2000文字の範囲内か
```

---

# 評価4: 幻覚対策

### チェックリスト

```
✅ 「含まれる情報」が明示されているか
   - ファイルの対象範囲が明確

✅ 「含まれない情報」が列挙されているか
   - 推測してはいけない情報が明記

✅ 更新日・時点が記載されているか
   - 「2025年1月時点」など

✅ Instructionsの例外処理と連携しているか
   - 幻覚対策フレーズが使える設計
```

---

# 評価5: 実用性

### チェックリスト

```
✅ 実際の業務で使える情報か
   - 抽象的すぎないか
   - 具体例が含まれているか

✅ 誤りや矛盾がないか
   - 数値、日付、名称の正確性

✅ 読みやすいフォーマットか
   - 表、リスト、見出しの適切な活用
```

---

# 評価シート

### 各観点の評価

| 観点 | 評価（1-5） | コメント |
|---|---|---|
| 構造品質 | __ | |
| 検索最適化 | __ | |
| 自己完結性 | __ | |
| 幻覚対策 | __ | |
| 実用性 | __ | |
| **総合** | __/25 | |

> 20点以上で合格、15-19点は改善推奨、14点以下は再生成

---

# 運用時のKPI（参考）

### 定量的な測定指標

| KPI | 定義 | 目標値 | 測定方法 |
|---|---|---|---|
| **検索ヒット率** | 質問に対して関連情報が返る割合 | 90%以上 | テストケース10件で計測 |
| **無回答率** | 「情報がありません」と返す割合 | 10%未満 | 想定質問での検証 |
| **誤回答率** | 事実と異なる回答の割合 | 0% | 手動レビュー |
| **幻覚発生率** | Knowledge外の推測回答の割合 | 0% | 例外処理動作確認 |

> **運用開始後**: 定期的にKPIを測定し、知識ファイルを改善

---

# KPI測定の実施方法

### テストケースによる検証

```
【検索ヒット率の測定】
1. 想定質問を10件用意
2. GPTsに質問を投げる
3. 正しい情報が返ったか確認
4. ヒット数/10 = ヒット率

【誤回答率の測定】
1. 回答内容を事実と照合
2. 誤りがあれば記録
3. 誤回答数/総回答数 = 誤回答率

【幻覚発生率の測定】
1. Knowledge外の質問を投げる
2. 「確認が必要です」と返るか確認
3. 推測回答数/範囲外質問数 = 幻覚発生率
```

---

<!-- _class: lead -->
# Part 5: 改善ループ

---

# 改善の進め方

### 段階的な改善

```
┌─────────────────────────────────────────────────────┐
│                   改善ループ                         │
└─────────────────────────────────────────────────────┘

  1. 評価シートで問題点を特定
       ↓
  2. 優先度の高い問題を選択（最大3つ）
       ↓
  3. 具体的な修正依頼を作成
       ↓
  4. AIに修正を依頼
       ↓
  5. 再評価
       ↓
  (改善が必要なら 2 に戻る、最大3回)
```

---

# 改善依頼の書き方

### 具体的な指示

```
【悪い例】
「もっと良くして」
「検索しやすくして」
→ 曖昧で改善点が不明確

【良い例】
「以下の点を修正してください：
 1. products.md のチャンク3に同義語を追加
    - 「返品」→「返品・キャンセル・解約」
 2. FAQ.json に「送料」関連のQ&Aを3件追加
 3. 各ファイル冒頭に『含まれない情報』セクションを追加」
→ 具体的で実行可能
```

---

# よくある改善パターン

### 問題と対策

| 問題 | 改善依頼例 |
|---|---|
| キーワード不足 | 「〇〇の同義語として△△を追加」 |
| チャンク大きすぎ | 「セクション2を3つに分割」 |
| 幻覚対策なし | 「冒頭に範囲明示を追加」 |
| 抽象的すぎる | 「具体例を3つ追加」 |
| 構造が不明確 | 「見出しレベルを整理」 |

---

# 改善の優先順位

### どこから直すか

```
優先度 高
  │
  ├── 1. 幻覚対策がない → 安全性に関わる
  │
  ├── 2. 情報の誤り → 信頼性に関わる
  │
  ├── 3. チャンク設計の問題 → 検索精度に関わる
  │
  ├── 4. 検索最適化の不足 → 使いやすさに関わる
  │
  └── 5. フォーマットの改善 → 見やすさの問題
  │
優先度 低
```

---

# 改善例: Before/After

### 幻覚対策の追加

```markdown
【Before】
# 商品カタログ

## 商品A
価格: 128,000円
仕様: ...

---

【After】
# 商品カタログ

## このファイルについて
- 対象: 2025年1月時点の商品情報
- 含まれない情報: 在庫状況、法人価格、キャンペーン価格
- これらについては営業担当にお問い合わせください

## 商品A
価格: 128,000円（定価・税抜）
仕様: ...
```

---

# 改善ループのタイムボックス

### 効率的な改善

| 回数 | 作業 | 時間上限 |
|---|---|---|
| 1回目 | 重大な問題の修正 | 10分 |
| 2回目 | 中程度の問題の修正 | 10分 |
| 3回目 | 軽微な問題の修正 | 10分 |
| **合計** | | **30分** |

> 3回で改善が終わらない場合は、振り返りに記録して完了

---

<!-- _class: lead -->
# Part 6: Good例とBad例

---

# Good例: 商品カタログ（Markdown）

### 検索最適化された構造

```markdown
---
category: 商品情報
tags: [商品, カタログ, 価格, 製品]
updated: 2025-01-15
---

# 商品カタログ・製品一覧

## 本ファイルの範囲
- 含む: 商品名、定価、基本仕様
- 含まない: 在庫、法人価格、過去製品

## ビジネスノートPC PRD001

### 商品概要
ビジネス向け14インチノートPC。
軽量設計で持ち運びに最適。

### 価格・仕様
- 定価: 128,000円（税抜）
- 重量: 1.2kg
- バッテリー: 12時間
```

---

# Bad例: 商品カタログ

### 問題点を確認

```markdown
# カタログ

PRD001 ノートPC 128000

PRD002 マウス 3500

PRD003 モニター 45000
```

### 問題点

| 問題 | 詳細 |
|---|---|
| ❌ メタデータなし | 検索分類ができない |
| ❌ 説明が不足 | 何の商品か分からない |
| ❌ 幻覚対策なし | 範囲が不明 |
| ❌ チャンク設計なし | 情報が一塊 |

---

# Good例: FAQ（JSON）

### 構造化されたQ&A

```json
{
  "metadata": {
    "category": "カスタマーサポート",
    "updated": "2025-01-15",
    "scope": "返品・交換・配送に関するFAQ"
  },
  "faq": [
    {
      "id": "FAQ001",
      "category": "返品",
      "question": "返品はできますか？返品可能ですか？",
      "answer": "はい、未開封品は14日以内に返品可能です。",
      "keywords": ["返品", "キャンセル", "返金"]
    }
  ]
}
```

---

# Bad例: FAQ

### 問題点を確認

```
Q1: 返品できる？
A1: できます

Q2: 送料は？
A2: かかります
```

### 問題点

| 問題 | 詳細 |
|---|---|
| ❌ 構造化されていない | 検索精度が低い |
| ❌ 回答が不十分 | 条件が不明 |
| ❌ キーワードがない | 類語でヒットしない |
| ❌ IDがない | 管理が困難 |

---

# Good例: 幻覚対策

### 明確な範囲設定

```markdown
# 本知識ベースの利用について

## 情報の有効期限
本ファイルは2025年1月15日時点の情報です。

## 含まれる情報
- 商品の基本情報（名称、定価、仕様）
- 標準的な返品・交換ポリシー
- よくある質問（FAQ）50件

## 含まれない情報（推測禁止）
- リアルタイム在庫状況
- 法人向け特別価格
- キャンペーン・セール情報
- 個別の契約条件

上記の情報については「担当者にご確認ください」と案内してください。
```

---

# Bad例: 幻覚対策

### 範囲が不明確

```markdown
# 商品情報

以下は商品の情報です。
...
```

### 問題点

| 問題 | リスク |
|---|---|
| ❌ 時点が不明 | 古い情報を正しいと回答 |
| ❌ 範囲が不明 | 推測で回答してしまう |
| ❌ 除外情報なし | 幻覚が発生 |

---

<!-- _class: lead -->
# Part 7: 実習のまとめ

---

# EX-15: 知識ベース設計メタプロンプト

### 提出物

1. **メタプロンプト本体**（変数化されたもの）
2. **変数定義シート**（各変数の説明）
3. **動作確認ログ**（Phase 1の対話）
4. **振り返り**

### 評価基準

- 3フェーズ構造が明確か
- 確認観点が網羅されているか
- DoDが固定で含まれているか

---

# EX-16: 知識ファイル（AI生成）

### 提出物

1. **使用したメタプロンプト**
2. **生成された知識ファイル**（1-3ファイル）
3. **評価シート**（5観点×5段階）
4. **改善ログ**（修正依頼と結果）
5. **振り返り**

### 評価基準

- チャンク設計に沿っているか
- 検索最適化が適用されているか
- 幻覚対策が含まれているか

---

# Session 6-8の成果物連鎖（確認）

### ここまでの成果物

```
Session 6
├── EX-11: GPTs企画メタプロンプト
└── EX-12: GPTs企画書

Session 7
├── EX-13: Instructions生成メタプロンプト
└── EX-14: Instructions v1

Session 8
├── EX-15: 知識ベース設計メタプロンプト ← 今作成
└── EX-16: 知識ファイル v1 ← 今作成

Session 9-10
└── 統合・テスト・完成
```

---

# 次のステップ

### Session 9以降の予定

| Session | 内容 | 目標 |
|---|---|---|
| 9 | GPTs統合・テスト | 3要素を組み合わせて動作確認 |
| 10 | 評価・改善・完成 | 実運用レベルまで品質向上 |
| 11-12 | 最終プレゼン・振り返り | 成果発表、学びの定着 |

---

# Session 8-2 まとめ

### 本動画で学んだこと

| トピック | 内容 |
|---|---|
| **実行準備** | GPTs企画書・Instructionsを入力として準備 |
| **3フェーズ実行** | ヒアリング→設計書→ファイル生成 |
| **評価の観点** | 構造・検索・自己完結・幻覚対策・実用性 |
| **改善ループ** | 具体的な修正依頼、最大3回 |
| **Good/Bad例** | 検索最適化・幻覚対策の有無 |

---

# 次回予告

### Session 9: GPTs統合・テスト

- Instructions + Knowledge + (Actions) の統合
- テストシナリオの作成と実行
- 問題点の特定と改善

---

<!-- _class: lead -->
# お疲れさまでした！

Session 9へ続く
