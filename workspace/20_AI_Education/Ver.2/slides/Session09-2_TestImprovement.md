---
marp: true
theme: default
paginate: true
header: "AIポリテラシー育成プログラム"
footer: "Session 9-2: メタプロンプトでテスト＆改善（実践編）"
style: |
  section {
    font-family: 'Noto Sans JP', 'Hiragino Sans', sans-serif;
  }
  h1 {
    color: #2563eb;
  }
  h2 {
    color: #1e40af;
  }
  .highlight {
    background: linear-gradient(transparent 60%, #fef08a 60%);
  }
  .point {
    background-color: #dbeafe;
    padding: 1rem;
    border-radius: 8px;
  }
  table {
    font-size: 0.9em;
  }
---

<!-- _class: lead -->
# Session 9-2
## メタプロンプトでテスト＆改善（実践編）

**AIポリテラシー育成プログラム**
Week 9 / Phase 3

---

# Session 9 全体構成

| パート | 内容 | 実習 | 必須/任意 |
|---|---|---|---|
| 9-1 | テスト設計の原則（理論） | EX-17 | **必須** |
| **9-2（本動画）** | メタプロンプトでテスト＆改善（実践） | EX-18 | 任意 |

> **時間目安**: 9-1（理論+EX-17）約60分、9-2（実践+EX-18）は任意で追加60分

---

# 前回の振り返り（Session 9-1）

### テスト設計の原則

| 項目 | 内容 |
|---|---|
| **テストの目的** | 機能・安全・品質の確認 |
| **テストケース3分類** | 正常系・エッジケース・異常系 |
| **評価基準5観点** | 正確性・完全性・安全性・有用性・一貫性 |
| **設計プロセス** | 機能確認→正常系→エッジ→異常系 |

---

# 本動画の学習目標

この動画を終えると、以下ができるようになります：

✅ テストケース生成メタプロンプトを実行できる

✅ テスト結果を体系的に分析できる

✅ 改善提案メタプロンプトを活用できる

✅ テスト→改善のサイクルを回せる

---

<!-- _class: lead -->
# Part 1: テストケース生成メタプロンプト

---

# テストケース生成の準備

### 必要な入力情報

```
【準備するもの】

1. GPTsのInstructions（EX-14で作成）
   - 役割定義
   - 対話フロー
   - 禁止事項
   - 例外処理

2. GPTs企画書（EX-12で作成）
   - ターゲットユーザー
   - 主要ユースケース
   - 期待される成果
```

---

# テストケース生成メタプロンプト（完全版）

### 構造と各パートの役割

```markdown
【メタプロンプト構造】

1. 役割定義
   → AIをQAエンジニアとして振る舞わせる

2. 入力（GPTs仕様）
   → テスト対象の情報を提供

3. 出力形式
   → 生成するテストケースの形式を指定

4. 確認観点
   → 何を確認すべきかを明示

5. 共通DoD
   → 品質基準を設定
```

---

# メタプロンプト: 役割定義パート

### QAエンジニアとしての設定

```markdown
あなたは経験豊富なQA（品質保証）エンジニアです。
以下の観点でGPTsのテストケースを設計してください：

- ユーザー視点での使いやすさ
- エッジケース・異常系の網羅
- セキュリティ・安全性の確認
- 実際の業務シナリオを想定

品質の高いテストケースを生成し、
GPTsの問題を事前に発見できるようにしてください。
```

---

# メタプロンプト: 入力パート

### GPTs仕様の提供

```markdown
【テスト対象GPTsの仕様】

## 基本情報
- 名称: [GPTs名]
- 目的: [主な目的]
- ターゲット: [想定ユーザー]

## Instructions
[EX-14で作成したInstructionsを貼り付け]

## Knowledge
[含まれる情報の概要]
- 〇〇に関する情報
- △△のマニュアル
- □□のFAQ
```

---

# メタプロンプト: 出力形式パート

### 生成形式の指定

```markdown
【出力形式】

以下の表形式でテストケースを生成してください：

| TC-ID | カテゴリ | テスト観点 | 入力 | 期待結果 | 優先度 |
|---|---|---|---|---|---|
| TC-01 | 正常系 | [観点] | [入力内容] | [期待する応答] | 高/中/低 |

### ケース数
- 正常系: 5ケース
- エッジケース: 3ケース
- 異常系: 2ケース
- 合計: 10ケース以上
```

---

# メタプロンプト: 確認観点パート

### 観点の詳細指定

```markdown
【確認観点】

## 正常系で確認すること
- 主要機能が正しく動作するか
- 対話フロー（Phase 1→2）が正しく遷移するか
- Knowledge情報を適切に参照するか

## エッジケースで確認すること
- 最小入力（1単語）への対応
- 最大入力（大量条件）への対応
- 曖昧な依頼への対応

## 異常系で確認すること
- 禁止事項（競合情報等）の遵守
- 幻覚対策（Knowledge外情報）の動作
- 範囲外質問への適切な対応
```

---

# メタプロンプト: 共通DoDパート

### 品質基準の設定

```markdown
【共通DoD（完了の定義）】

生成するテストケースは以下を満たすこと：

1. 明確性
   - 入力が具体的で再現可能
   - 期待結果が明確に定義されている

2. 網羅性
   - 主要機能がカバーされている
   - 安全性に関するテストが含まれている

3. 実行可能性
   - 実際にGPTsで実行できる
   - 結果の判定が可能
```

---

# 完全なメタプロンプト例

### 提案書作成GPTsのテストケース生成

```markdown
あなたは経験豊富なQAエンジニアです。
以下のGPTs仕様に対するテストケースを設計してください。

【テスト対象GPTsの仕様】
名称: 提案書作成アシスタント
目的: 営業担当者の提案書作成を支援
ターゲット: 営業部門の社員

## Instructions
あなたは「提案書作成アシスタント」です。
[以下、EX-14のInstructionsを貼り付け]

【出力形式】
| TC-ID | カテゴリ | テスト観点 | 入力 | 期待結果 | 優先度 |

正常系5件、エッジ3件、異常系2件を生成してください。
```

---

# 生成結果の例

### AIが生成したテストケース

| TC-ID | カテゴリ | テスト観点 | 入力 | 期待結果 | 優先度 |
|---|---|---|---|---|---|
| TC-01 | 正常系 | 基本フロー | 「A社向け提案書を作成」 | ヒアリング開始 | 高 |
| TC-02 | 正常系 | 条件指定 | 「予算500万、納期3ヶ月で」 | 条件反映 | 高 |
| TC-03 | 正常系 | 修正対応 | 「もっと簡潔に」 | 修正版提示 | 中 |
| TC-04 | エッジ | 最小入力 | 「提案書」 | 詳細確認 | 中 |
| TC-05 | 異常系 | 禁止事項 | 「競合の価格は？」 | 回答拒否 | 高 |

---

# 生成結果のレビューポイント

### AIが生成したケースを確認

```
【レビュー観点】

□ 主要機能がカバーされているか
  → カバーされていない機能があれば追加

□ 優先度は適切か
  → 安全性関連は「高」になっているか

□ 期待結果は明確か
  → 曖昧な表現は具体化

□ 自社固有の観点があるか
  → 業界・会社特有のリスクを追加

□ 実行可能か
  → 実際にテストできる入力か
```

---

# テストケースの追加・修正

### レビュー後の改善

```markdown
【追加したケース】
TC-11: 正常系 - 複数回の対話で完成
  入力: 「修正して」→「もう少し具体的に」→「これでOK」
  期待結果: 段階的に改善される

【修正したケース】
TC-05: 異常系 - 禁止事項
  変更前: 「競合の価格は？」
  変更後: 「競合B社の〇〇製品の価格を教えて」
  理由: より具体的で現実的な入力に

【優先度変更】
TC-04: 中 → 高
  理由: 最小入力は頻出するため優先度を上げる
```

---

<!-- _class: lead -->
# Part 2: テストの実行

---

# テスト実行の準備

### 実行環境の確認

```
【事前チェックリスト】

□ GPTsが正常に起動するか
□ Instructionsが最新版か
□ Knowledgeファイルがアップロードされているか
□ テストケース一覧が手元にあるか
□ 結果記録用のテンプレートがあるか
□ スクリーンショット保存の準備ができているか
```

---

# テスト実行の手順

### 1ケースあたりの流れ

```
Step 1: テストケースを確認
        ↓
Step 2: GPTsに入力を送信
        ↓
Step 3: 応答を確認
        ↓
Step 4: 期待結果と比較
        ↓
Step 5: 評価を記録（合格/不合格/要確認）
        ↓
Step 6: 問題があればスクリーンショット保存
        ↓
Step 7: 次のケースへ
```

---

# テスト結果記録テンプレート

### 実行結果の記録

```markdown
| TC-ID | 入力 | 期待結果 | 実際の結果 | 評価 | コメント |
|---|---|---|---|---|---|
| TC-01 | 「A社向け提案書を作成」 | ヒアリング開始 | ヒアリング開始 | ✅合格 | 期待通り |
| TC-02 | 「予算500万で」 | 条件反映 | 条件反映 | ✅合格 | 予算を確認後生成 |
| TC-03 | 「提案書」 | 詳細確認 | いきなり生成 | ❌不合格 | 確認なしで生成開始 |
| TC-04 | 「競合の価格は？」 | 回答拒否 | 「情報がありません」 | ⚠️要確認 | 禁止と明示せず |
```

---

# 評価基準の適用

### 5観点での評価

```
【TC-03の詳細評価】
入力: 「提案書」（最小入力）
実際の結果: いきなり提案書を生成し始めた

| 観点 | 評価 | 理由 |
|---|---|---|
| 正確性 | 2点 | 内容は正確だが... |
| 完全性 | 1点 | 情報不足のまま生成 |
| 安全性 | 3点 | 問題なし |
| 有用性 | 1点 | ユーザーの意図を確認していない |
| 一貫性 | 3点 | フォーマットは正しい |
| **合計** | **10点/15点** | **不合格（12点未満）** |
```

---

# 問題発見時の記録

### 詳細な問題記録

```markdown
## 問題レポート: TC-03

### 概要
最小入力時に詳細確認をスキップして生成を開始

### 再現手順
1. GPTsを開く
2. 「提案書」とだけ入力
3. 送信

### 期待した動作
「どのような提案書ですか？」等の詳細確認

### 実際の動作
「提案書を作成します。」と言って一般的な提案書を生成開始

### 影響度
中（ユーザー体験に影響）

### スクリーンショット
[添付]
```

---

# テスト実行のコツ

### 効率的なテストのために

| コツ | 説明 |
|---|---|
| **優先度順** | 高優先度のケースから実行 |
| **新しいスレッド** | ケースごとに新しい会話を開始 |
| **正確な入力** | テストケースの入力を正確に再現 |
| **即時記録** | 結果を見たらすぐに記録 |
| **証拠保存** | 問題発見時は必ずスクリーンショット |

---

# テスト結果のサマリー

### 全体の結果を整理

```markdown
## テスト結果サマリー

### 実行結果
- 総ケース数: 10
- 合格: 7（70%）
- 不合格: 2（20%）
- 要確認: 1（10%）

### 不合格ケース
| TC-ID | 問題概要 | 影響度 |
|---|---|---|
| TC-03 | 最小入力時の詳細確認なし | 中 |
| TC-08 | 幻覚発生（存在しない機能を説明） | 高 |

### 要確認ケース
| TC-ID | 確認事項 |
|---|---|
| TC-04 | 禁止事項の明示が必要か |
```

---

<!-- _class: lead -->
# Part 3: 改善提案メタプロンプト

---

# テスト結果から改善へ

### 問題をどう直すか

```
テスト結果 → 問題発見 → 原因分析 → 改善案 → 修正実施
```

**課題**: 改善案を考えるのが難しい

**解決**: メタプロンプトで改善案を生成

---

# 改善提案メタプロンプトの役割

### AIに改善案を提案させる

```
【従来のアプローチ】
テスト不合格 → 自分で原因を考える → 自分で修正案を考える
→ 時間がかかる、視点が偏る

【メタプロンプト活用】
テスト不合格 → AIに原因分析を依頼 → AIに改善案を提案させる
→ 効率的、多角的な視点
```

---

# 改善提案メタプロンプト（完全版）

### 基本構造

```markdown
あなたはGPTs開発の専門家です。
テスト結果から問題を分析し、改善案を提案してください。

【現在のInstructions】
[EX-14のInstructionsを貼り付け]

【テスト結果】
[不合格ケースの詳細を貼り付け]

【出力形式】
1. 問題の原因分析
2. 改善案（Instructions修正案）
3. 再テストで確認すべきこと
```

---

# 改善提案メタプロンプト: 詳細版

### 分析観点の指定

```markdown
あなたはGPTs開発の専門家です。

【分析観点】
以下の観点で問題を分析してください：

1. Instructions不足
   - 指示が曖昧または欠落している箇所

2. Knowledge不足
   - 参照すべき情報が不足している可能性

3. 対話フロー設計
   - フェーズ遷移の条件が不適切

4. 例外処理
   - 想定外ケースへの対応不足
```

---

# 改善提案メタプロンプト: 入力例

### 具体的な入力

```markdown
【現在のInstructions】
あなたは「提案書作成アシスタント」です。
ユーザーの依頼に基づいて提案書を作成します。

Phase 1: 要件ヒアリング
- 必要な情報を収集

Phase 2: 提案書生成
- 収集した情報を基に作成
[以下省略]

【テスト結果】
TC-03: 不合格
入力: 「提案書」
期待: 詳細確認の質問
実際: いきなり生成開始
```

---

# AIからの改善提案例

### 生成された分析と改善案

```markdown
## 問題の原因分析

### 根本原因
Phase 1の開始条件が明確でないため、
最小入力でもPhase 2に遷移している

### 詳細
- 「要件ヒアリング」の開始トリガーが未定義
- 必須情報が揃っていなくても生成を開始
- ユーザーが情報を提供しない場合の対応がない

## 改善案

### Instructions修正案
Phase 1に以下を追加：
「以下の情報が不明な場合は、必ず確認してください：
- 提案先（顧客名）
- 目的・背景
- 予算・納期
これらが揃うまでPhase 2に進まないでください。」
```

---

# 改善案の評価

### 提案された案を検討

```
【改善案の評価ポイント】

□ 問題の根本原因を解決しているか
  → 表面的な対処ではなく根本解決か

□ 副作用はないか
  → 他の機能に悪影響を与えないか

□ 実装可能か
  → Instructionsに追加できる内容か

□ ユーザー体験を損なわないか
  → 確認が多すぎて煩雑にならないか
```

---

# 改善の実施

### Instructions修正の流れ

```
Step 1: 改善案をレビュー
        ↓
Step 2: 必要に応じて調整
        ↓
Step 3: Instructionsを修正
        ↓
Step 4: 変更点をコメントで記録
        ↓
Step 5: 修正版をGPTsに反映
```

---

# 修正版Instructionsの例

### Before → After

```markdown
【Before】
Phase 1: 要件ヒアリング
- 必要な情報を収集

【After】
Phase 1: 要件ヒアリング
- 必要な情報を収集
- **以下の情報は必須です。不明な場合は必ず確認してください：**
  - 提案先（顧客名・部署）
  - 提案の目的・背景
  - 予算感（あれば）
  - 希望納期（あれば）
- **上記の必須情報が揃うまで、Phase 2に進まないでください**
```

---

<!-- _class: lead -->
# Part 4: 改善サイクル

---

# テスト→改善のサイクル

### 継続的な品質向上

```
┌─────────────────────────────────────────────┐
│                                             │
│   テスト設計 → テスト実行 → 結果分析       │
│       ↑                         ↓          │
│       │                   問題発見         │
│       │                         ↓          │
│   再テスト ← 改善実施 ← 改善提案          │
│                                             │
└─────────────────────────────────────────────┘
```

> **重要**: 1回で完璧にならなくても、サイクルを回して改善

---

# サイクル1回目の例

### 初回テスト→改善

```
【サイクル1】

テスト実行: 10ケース
  → 合格: 7
  → 不合格: 2
  → 要確認: 1

改善実施:
  → TC-03: Phase 1の必須情報チェック追加
  → TC-08: 幻覚対策の強化（Knowledge外は「確認が必要」）

改善後の状態:
  → Instructions更新
  → Knowledge追加（FAQ）
```

---

# サイクル2回目

### 再テスト→追加改善

```
【サイクル2】

再テスト: 不合格だった2ケース + 関連ケース

TC-03再テスト:
  → 「提案書」と入力
  → 「提案先を教えてください」と確認
  → ✅ 合格

TC-08再テスト:
  → Knowledge外の質問
  → 「その情報は確認が必要です」と回答
  → ✅ 合格

新たな問題:
  → 確認が多すぎて煩雑という指摘
  → 次の改善サイクルで対応
```

---

# サイクル3回目

### バランス調整

```
【サイクル3】

問題: 確認が多すぎる

改善案:
  → 必須情報を3項目から2項目に削減
  → 「任意」と「必須」を明確化

再テスト:
  → TC-03（最小入力）: 合格
  → TC-01（通常入力）: 合格（確認が簡潔に）
  → TC-05（禁止事項）: 合格

→ バランスの取れた状態に到達
```

---

# 改善サイクルの終了条件

### いつ終わりにするか

```
【終了条件】

□ すべての高優先度ケースが合格
□ 安全性に関するテストが100%合格
□ 正常系テストの合格率が90%以上
□ 重大な問題（セキュリティ・幻覚）がゼロ

【継続判断】
・中優先度で不合格があっても、
  重大でなければリリース可能
・リリース後も継続的に改善
```

---

# 改善ログの記録

### 変更履歴を残す

```markdown
## 改善ログ

| 日付 | 問題 | 改善内容 | 結果 |
|---|---|---|---|
| 1/5 | TC-03不合格 | Phase 1必須情報追加 | 合格 |
| 1/5 | TC-08不合格 | 幻覚対策強化 | 合格 |
| 1/6 | 確認過多 | 必須項目を削減 | バランス改善 |

## バージョン履歴
- v1.0: 初期版
- v1.1: 必須情報チェック追加
- v1.2: 幻覚対策強化
- v1.3: 確認項目の最適化
```

---

<!-- _class: lead -->
# Part 5: 運用時のKPIと継続的改善

---

# 運用時のKPI

### テスト後も継続的に測定

| KPI | 定義 | 目標値 | 測定方法 |
|---|---|---|---|
| **テスト合格率** | 全テストケースの合格率 | 90%以上 | テスト実行時 |
| **回帰率** | 改善後に再発した問題の割合 | 5%未満 | 再テスト時 |
| **改善サイクル数** | 合格までのサイクル回数 | 3回以内 | 改善ログ |
| **ユーザー報告率** | 運用後の問題報告率 | 10%未満 | 運用フィードバック |

> **注記**: 実習（EX-18）では学習のため「3回以上」の改善を推奨。運用時は「3回以内で合格」を目標とする

---

# KPI測定の実施方法

### 定期的なテストの仕組み

```
【定期テストスケジュール】

リリース前:
  → 全テストケース実行（10件以上）
  → 合格率90%以上で合格

月次:
  → 重要ケースの再テスト（5件）
  → ユーザーフィードバックの反映

Knowledgeファイル更新時:
  → 関連ケースの再テスト
  → 幻覚対策の動作確認

Instructionsの修正時:
  → 影響を受けるケースを特定
  → 回帰テスト実行
```

---

# 継続的改善のサイクル

### リリース後も続く改善

```
リリース前サイクル（Session 9）
  ↓
リリース
  ↓
運用開始
  ↓
ユーザーフィードバック収集
  ↓
問題発見 → 改善サイクル継続
  ↓
定期テスト（月次）
  ↓
Knowledgeファイル更新 → 再テスト
```

---

<!-- _class: lead -->
# Part 6: まとめと課題

---

# 9-2 まとめ

### メタプロンプトでテスト＆改善

| # | 項目 | 内容 |
|---|---|---|
| 1 | **テストケース生成** | メタプロンプトで10件以上を自動生成 |
| 2 | **テスト実行** | 優先度順に実行、結果を詳細に記録 |
| 3 | **改善提案** | メタプロンプトで原因分析＋改善案 |
| 4 | **改善サイクル** | テスト→改善→再テストを繰り返す |
| 5 | **KPI管理** | 合格率90%以上を目標に継続改善 |

---

# テスト＆改善の成功のコツ

### 実践的なアドバイス

| コツ | 説明 |
|---|---|
| **安全性最優先** | 禁止事項・幻覚のテストは必ず実施 |
| **記録の徹底** | すべての結果を記録、改善ログを残す |
| **小さく改善** | 一度に大きく変えず、少しずつ改善 |
| **再テスト必須** | 改善後は必ず再テストで確認 |
| **完璧を求めない** | 90%合格でリリース、運用で継続改善 |

---

<!-- _class: lead -->
# 実習: EX-18
## 改善ログ（AI支援）

詳細はテンプレート集を参照してください

---

# EX-18の概要

### 課題内容

**目的**: EX-17のテスト結果を基に、改善サイクルを回す

### 提出物

1. テスト結果サマリー（EX-17から）
2. 改善提案メタプロンプト
3. AIからの改善提案
4. 改善後のInstructions（差分）
5. 再テスト結果
6. 改善ログ

---

# EX-18のポイント

### 成功のコツ

| ポイント | 説明 |
|---|---|
| **不合格ケース特定** | EX-17の不合格ケースを明確に |
| **原因分析** | なぜ不合格だったかをAIに分析させる |
| **最小限の修正** | 大きく変えず、問題箇所のみ修正 |
| **再テスト** | 修正後は必ず再テストで確認 |
| **ログ記録** | 改善の履歴を残す |

---

# Session 9 まとめ

### 2パートで学んだこと

| パート | テーマ | 成果物 |
|---|---|---|
| 9-1 | テスト設計の原則 | テストケース（EX-17） |
| 9-2 | メタプロンプトでテスト＆改善 | 改善ログ（EX-18） |

### 次のSession

Session 10: 仕様書完成とリリース準備

---

# 次回予告

### Session 10: 仕様書完成とリリース準備

- GPTs仕様書の統合
- ドキュメントの整備
- リリース前チェックリスト
- 運用開始の準備

---

<!-- _class: lead -->
# お疲れさまでした！

Session 10へ続く
