---
marp: true
theme: default
paginate: true
header: "AIポリテラシー育成プログラム"
footer: "Session 9-1: テスト設計の原則（理論編）"
style: |
  section {
    font-family: 'Noto Sans JP', 'Hiragino Sans', sans-serif;
  }
  h1 {
    color: #2563eb;
  }
  h2 {
    color: #1e40af;
  }
  .highlight {
    background: linear-gradient(transparent 60%, #fef08a 60%);
  }
  .point {
    background-color: #dbeafe;
    padding: 1rem;
    border-radius: 8px;
  }
  table {
    font-size: 0.9em;
  }
---

<!-- _class: lead -->
# Session 9-1
## テスト設計の原則（理論編）

**AIポリテラシー育成プログラム**
Week 9 / Phase 3

---

# Session 9 全体構成

| パート | 内容 | 実習 | 必須/任意 |
|---|---|---|---|
| **9-1（本動画）** | テスト設計の原則（理論） | EX-17 | **必須** |
| 9-2 | メタプロンプトでテスト＆改善（実践） | EX-18 | 任意 |

> **時間目安**: 9-1（理論+EX-17）約60分、9-2（実践+EX-18）は任意で追加60分

---

# 前回の振り返り（Session 8）

### 学んだこと

| Session | テーマ | 成果物 |
|---|---|---|
| 8-1 | 知識ベース設計の原則 | チャンク設計・検索最適化 |
| 8-2 | メタプロンプトで知識ベース生成 | **知識ファイル v1（EX-16）** |

### 今日の位置づけ

```
Session 6: GPTs企画書
         ↓
Session 7: Instructions生成
         ↓
Session 8: 知識ベース構築
         ↓
Session 9: テスト・改善 ← 今ここ
         ↓
Session 10: 仕様書完成
```

---

# 本動画の学習目標

この動画を終えると、以下ができるようになります：

✅ GPTsテストの目的と重要性を理解できる

✅ テストケースの種類（正常系・エッジ・異常系）を設計できる

✅ 評価基準を定義し、品質を測定できる

---

<!-- _class: lead -->
# Part 1: なぜテストが必要か

---

# GPTsにもテストが必要

### 「動くから完成」ではない

```
【テストなしでリリースした場合】
ユーザー: 「返品ポリシーを教えて」
GPTs: 「返品は30日以内に...」（実際は14日）
→ 誤った情報で顧客対応してしまう

ユーザー: 「競合他社の価格は？」
GPTs: 「A社は〇〇円で...」（機密扱いなのに回答）
→ 禁止事項を守れていない
```

> **問題**: 一見動いているように見えても、品質問題が潜んでいる

---

# テストの目的

### 3つの目的

| 目的 | 内容 | 例 |
|---|---|---|
| **1. 機能確認** | 期待通りに動作するか | 正しい情報を返すか |
| **2. 安全確認** | 禁止事項を守れているか | 機密情報を漏らさないか |
| **3. 品質確認** | ユーザー体験が良いか | 分かりやすい回答か |

---

# テストしないとどうなるか

### よくある失敗パターン

| パターン | 問題 | 影響 |
|---|---|---|
| **幻覚発生** | Knowledge外の情報を推測 | 誤情報の提供 |
| **禁止違反** | 競合情報・機密を回答 | コンプライアンス違反 |
| **文脈誤解** | 質問の意図を取り違え | ユーザー不満 |
| **出力乱れ** | フォーマットが崩れる | 使いにくい |
| **範囲外** | 想定外の質問に混乱 | 不適切な回答 |

---

# テストのタイミング

### いつテストするか

```
Session 6-7: 企画・Instructions作成
              ↓
Session 8: 知識ベース構築
              ↓
         ┌──────────────────────────┐
Session 9: │ テスト・改善サイクル    │ ← 今ここ
         │  テスト → 問題発見 → 修正 │
         │      ↓          ↑       │
         │      └──────────┘       │
         └──────────────────────────┘
              ↓
Session 10: 仕様書完成・リリース
```

> **重要**: リリース前に必ずテストを実施

---

# テストの投資対効果

### 早期発見のメリット

| 発見タイミング | 修正コスト | 影響範囲 |
|---|---|---|
| **テスト段階** | 低（自分で修正） | なし |
| **社内展開後** | 中（フィードバック対応） | 一部ユーザー |
| **全社展開後** | 高（緊急対応・信頼回復） | 全ユーザー |

> **原則**: 問題は早期に発見するほど修正コストが低い

---

<!-- _class: lead -->
# Part 2: テストケースの種類

---

# テストケースの3分類

### 正常系・エッジケース・異常系

```
┌─────────────────────────────────────────────────────┐
│                   テストケース                       │
├─────────────────┬────────────────┬─────────────────┤
│    正常系       │   エッジケース  │    異常系       │
│  Normal Cases   │   Edge Cases   │  Error Cases    │
├─────────────────┼────────────────┼─────────────────┤
│ 想定通りの入力  │ 境界・特殊ケース│ 想定外の入力    │
│ 基本機能の確認  │ 限界値の確認    │ エラー処理確認  │
│ 50%のケース     │ 30%のケース     │ 20%のケース     │
└─────────────────┴────────────────┴─────────────────┘
```

---

# 正常系テスト

### 基本機能が期待通り動くか

```
【テスト対象】
提案書作成GPTs

【正常系テストケース】
TC-01: 基本的な提案書作成依頼
  入力: 「A社向けの提案書を作成して」
  期待結果: ヒアリング開始 → 提案書生成

TC-02: 情報を入力した提案書作成
  入力: 「予算500万円、納期3ヶ月で提案書を作成」
  期待結果: 条件を反映した提案書を生成

TC-03: 修正依頼
  入力: 「もう少し簡潔にして」
  期待結果: 修正版を提示
```

---

# 正常系テストの設計ポイント

### 主要機能をカバー

| ポイント | 内容 | 例 |
|---|---|---|
| **主要フロー** | 基本的な使い方 | 提案書作成の標準フロー |
| **バリエーション** | 入力パターンの違い | 予算あり/なし、納期あり/なし |
| **対話の流れ** | Phase 1→2の遷移 | ヒアリング→生成→修正 |

> **目標**: 「普通に使ったら普通に動く」ことを確認

---

# エッジケーステスト

### 境界条件・特殊なケース

```
【エッジケーステスト例】

TC-04: 最小入力
  入力: 「提案書」
  期待結果: 詳細ヒアリングを開始

TC-05: 大量の条件指定
  入力: 「予算500万、納期3ヶ月、担当者3名、
        技術要件10項目、競合3社対応...」
  期待結果: 全条件を整理して確認

TC-06: 曖昧な依頼
  入力: 「いい感じのやつ作って」
  期待結果: 具体化のための質問
```

---

# エッジケースの発見方法

### どこにエッジがあるか

| 観点 | エッジケース例 |
|---|---|
| **入力長** | 極端に短い/長い入力 |
| **情報量** | 情報不足/情報過多 |
| **曖昧さ** | 抽象的・複数解釈可能な依頼 |
| **言語** | 専門用語・略語・口語 |
| **形式** | 箇条書き・表形式・自由文 |

---

# 異常系テスト

### 想定外の入力・エラー処理

```
【異常系テストケース例】

TC-07: 範囲外の質問
  入力: 「明日の天気は？」
  期待結果: 「専門外です」と案内

TC-08: 機密情報の入力
  入力: 「パスワードは xxxx です」
  期待結果: 警告を表示

TC-09: Knowledge外の質問
  入力: 「新商品Xの価格は？」（未登録商品）
  期待結果: 「確認が必要です」と回答（幻覚対策）
```

---

# 異常系テストの重要性

### 安全性を担保する

| テスト対象 | 確認内容 | 重要度 |
|---|---|---|
| **禁止事項遵守** | 禁止されている回答をしないか | 最高 |
| **幻覚対策** | 推測で回答しないか | 最高 |
| **例外処理** | 適切にエラーを処理するか | 高 |
| **境界処理** | 想定外入力で壊れないか | 中 |

> **最優先**: 安全性に関わるテストは必ず実施

---

# テストケース配分の目安

### バランスの取れた構成

```
【10ケースの場合の配分】

正常系: 5ケース (50%)
├── 基本フロー: 2件
├── バリエーション: 2件
└── 対話の流れ: 1件

エッジケース: 3ケース (30%)
├── 入力の極端値: 1件
├── 曖昧な依頼: 1件
└── 特殊フォーマット: 1件

異常系: 2ケース (20%)
├── 範囲外質問: 1件
└── 禁止事項: 1件
```

---

<!-- _class: lead -->
# Part 3: テストケースの設計

---

# テストケースの構成要素

### 5つの必須項目

| 項目 | 内容 | 例 |
|---|---|---|
| **TC-ID** | テストケース識別子 | TC-01, TC-02 |
| **カテゴリ** | 正常系/エッジ/異常系 | 正常系 |
| **入力** | GPTsへの入力内容 | 「提案書を作成して」 |
| **期待結果** | 想定される応答 | ヒアリング開始 |
| **優先度** | テストの重要度 | 高/中/低 |

---

# テストケーステンプレート

### 標準フォーマット

```markdown
| TC-ID | カテゴリ | 入力 | 期待結果 | 優先度 |
|---|---|---|---|---|
| TC-01 | 正常系 | 「A社向け提案書を作成」 | ヒアリング開始 | 高 |
| TC-02 | 正常系 | 「予算500万で作成」 | 条件を反映して生成 | 高 |
| TC-03 | エッジ | 「提案書」（最小入力） | 詳細確認の質問 | 中 |
| TC-04 | エッジ | 曖昧な依頼 | 具体化の質問 | 中 |
| TC-05 | 異常系 | 範囲外の質問 | 専門外と案内 | 高 |
| TC-06 | 異常系 | 機密情報入力 | 警告表示 | 高 |
```

---

# テストケース設計のステップ

### 4ステップの設計プロセス

```
Step 1: Instructions・機能一覧を確認
        ↓
Step 2: 正常系テストケースを洗い出し
        ↓
Step 3: エッジケースを追加
        ↓
Step 4: 異常系テストケースを追加
```

---

# Step 1: 機能一覧の確認

### Instructionsから機能を抽出

```markdown
【Instructions確認ポイント】

1. 基本動作指示 → 何ができるか
   - 提案書の作成
   - 修正・改善
   - 質問への回答

2. 対話フロー → どう動くか
   - Phase 1: ヒアリング
   - Phase 2: 生成

3. 禁止事項 → 何をしないか
   - 競合情報の提供
   - 機密情報の取り扱い

4. 例外処理 → 想定外にどう対応するか
   - 範囲外質問 → 専門外と案内
```

---

# Step 2: 正常系の洗い出し

### 機能ごとにテストケースを作成

```
【機能】提案書作成

正常系テストケース:
□ 基本的な依頼で作成できるか
□ 条件指定で反映されるか
□ 修正依頼に対応できるか
□ 複数回の対話で完成するか

【機能】質問応答

正常系テストケース:
□ Knowledgeにある質問に回答できるか
□ 適切なソースを参照しているか
```

---

# Step 3: エッジケースの追加

### 境界を意識してケースを追加

```
【エッジケース設計観点】

入力の境界:
□ 最小入力（1単語）
□ 最大入力（大量の条件）
□ 空入力に近い状態

内容の境界:
□ 曖昧な依頼
□ 複数の解釈が可能な依頼
□ 専門用語・略語の使用

形式の境界:
□ 箇条書き入力
□ 表形式入力
□ 対話の途中での方向転換
```

---

# Step 4: 異常系の追加

### 安全性を重点的に確認

```
【異常系テストケース観点】

禁止事項チェック:
□ 競合情報を聞いたら？
□ 機密情報を入力したら？
□ 不適切なコンテンツを依頼したら？

幻覚対策チェック:
□ Knowledge外の情報を聞いたら？
□ 存在しない商品を聞いたら？
□ 古い情報を聞いたら？

例外処理チェック:
□ 完全に範囲外の質問をしたら？
□ 意味不明な入力をしたら？
```

---

# テストケース設計のチェックリスト

### 設計完了時の確認

```
【設計チェックリスト】

□ 主要機能がすべてカバーされているか
□ 正常系・エッジ・異常系のバランスは適切か
□ 禁止事項のテストが含まれているか
□ 幻覚対策のテストが含まれているか
□ 期待結果が明確に定義されているか
□ 優先度が設定されているか
□ 10ケース以上あるか
```

---

<!-- _class: lead -->
# Part 4: 評価基準の設計

---

# なぜ評価基準が必要か

### 「良い」「悪い」の基準を明確に

```
【評価基準なしの場合】
テスター A: 「この回答、まあ良いと思う」
テスター B: 「いや、もう少し詳しい方が...」
→ 人によって判断がバラバラ

【評価基準ありの場合】
評価基準: 「必須項目5つがすべて含まれている」
テスター A: 「5項目中4項目、合格ライン未達」
テスター B: 「同意、4項目なので改善必要」
→ 客観的に判断できる
```

---

# 評価基準の5観点

### GPTsの品質を多角的に評価

| # | 観点 | 評価内容 |
|---|---|---|
| 1 | **正確性** | 情報が正しいか |
| 2 | **完全性** | 必要な情報がすべて含まれているか |
| 3 | **安全性** | 禁止事項を守れているか |
| 4 | **有用性** | ユーザーの目的を達成できるか |
| 5 | **一貫性** | フォーマット・トーンが統一されているか |

---

# 評価基準1: 正確性

### 情報が正しいか

```
【評価ポイント】

✅ 合格基準:
- Knowledgeの情報と一致している
- 数値・日付が正確
- 事実に基づいた回答

❌ 不合格:
- Knowledgeと異なる情報
- 推測・想像で回答（幻覚）
- 古い情報を最新として提示
```

---

# 評価基準2: 完全性

### 必要な情報がすべて含まれているか

```
【評価ポイント】

✅ 合格基準:
- 質問に対して過不足なく回答
- 必須項目がすべて含まれている
- 追加で聞かなくても理解できる

❌ 不合格:
- 一部の情報が欠落
- 「他にもありますが省略」のような回答
- 質問の一部にしか回答していない
```

---

# 評価基準3: 安全性

### 禁止事項を守れているか

```
【評価ポイント】

✅ 合格基準:
- 禁止事項に該当する回答をしていない
- 機密情報を漏らしていない
- 範囲外の質問を適切に断っている

❌ 不合格:
- 禁止事項に違反した回答
- 機密情報・個人情報の開示
- 不適切なコンテンツの生成
```

---

# 評価基準4: 有用性

### ユーザーの目的を達成できるか

```
【評価ポイント】

✅ 合格基準:
- ユーザーの意図を正しく理解
- 実際に使える回答・成果物
- 次のアクションが明確

❌ 不合格:
- 質問の意図を誤解
- 抽象的すぎて使えない
- 的外れな回答
```

---

# 評価基準5: 一貫性

### フォーマット・トーンが統一されているか

```
【評価ポイント】

✅ 合格基準:
- 指定されたフォーマットに従っている
- トーン（敬語/カジュアル）が一貫
- 出力形式が安定している

❌ 不合格:
- フォーマットがバラバラ
- トーンが途中で変わる
- 構成が毎回異なる
```

---

# 評価基準マトリックス

### 5観点×3段階の評価

| 観点 | 合格（3点） | 部分的（2点） | 不合格（1点） |
|---|---|---|---|
| 正確性 | 全て正確 | 軽微な誤り | 重大な誤り |
| 完全性 | 過不足なし | 一部欠落 | 大幅に欠落 |
| 安全性 | 違反なし | 軽微なリスク | 違反あり |
| 有用性 | 目的達成 | 一部達成 | 達成できず |
| 一貫性 | 完全に一貫 | 一部乱れ | 大幅に乱れ |

> **合格ライン**: 12点以上（15点満点）

---

# テスト結果の記録

### 結果記録テンプレート

```markdown
【実行環境】
- Instructionsバージョン: v1.0
- Knowledgeバージョン: v1.0
- 使用モデル: GPT-4o

| TC-ID | 入力 | 実際の結果 | 評価 | コメント |
|---|---|---|---|---|
| TC-01 | 提案書作成依頼 | ヒアリング開始 | 合格 | 期待通り |
| TC-02 | 条件指定 | 条件反映 | 合格 | 全条件を確認 |
| TC-03 | 最小入力 | エラー | 不合格 | 詳細確認なし |
| TC-04 | 範囲外質問 | 回答してしまった | 不合格 | 要修正 |

【不合格ケースの5観点スコア】
| TC-ID | 正確性 | 完全性 | 安全性 | 有用性 | 一貫性 | 合計 |
|---|:---:|:---:|:---:|:---:|:---:|:---:|
| TC-03 | 2 | 1 | 3 | 1 | 3 | 10 |
```

> **ポイント**: 環境情報を記録しておくと、問題の再現性確認や監査時に役立つ

---

<!-- _class: lead -->
# Part 5: メタプロンプトでテスト設計

---

# なぜメタプロンプトでテストするか

### テストケースもAIに生成させる

| 観点 | 手動設計 | メタプロンプト生成 |
|---|---|---|
| **時間** | 30-60分 | 5-10分 |
| **網羅性** | 漏れのリスク | 体系的に網羅 |
| **視点** | 自分の視点のみ | 多角的な視点 |
| **エッジケース** | 思いつきにくい | 自動で提案 |

---

# テストケース生成メタプロンプト

### 基本構造

```markdown
あなたはQAエンジニアです。
以下のGPTs仕様に対するテストケースを生成してください。

【GPTs仕様】
{Instructionsを貼り付け}

【出力形式】
- 正常系テスト（5ケース）
- エッジケーステスト（3ケース）
- 異常系テスト（2ケース）
- 各ケースに期待結果を含める

【共通DoD】
...
```

---

# メタプロンプトの詳細設計

### 確認観点を指定

```markdown
【確認観点】
正常系:
- 主要機能が動作するか
- 対話フローが正しく進むか

エッジケース:
- 入力の極端値（最小/最大）
- 曖昧な依頼への対応

異常系:
- 禁止事項の遵守
- 幻覚対策の動作
- 範囲外質問への対応
```

---

# 生成されたテストケースの活用

### AIが生成 → 人間がレビュー → 実行

```
Step 1: メタプロンプトでテストケース生成
        ↓
Step 2: 生成されたケースをレビュー
        ・抜け漏れはないか
        ・優先度は適切か
        ・期待結果は明確か
        ↓
Step 3: 必要に応じて追加・修正
        ↓
Step 4: テスト実行
        ↓
Step 5: 結果記録・分析
```

---

# テスト実行のポイント

### 効率的なテスト実行

| ポイント | 内容 |
|---|---|
| **優先度順** | 高優先度のケースから実行 |
| **記録の徹底** | 入力・結果・評価を必ず記録 |
| **スクリーンショット** | 問題があれば証拠を残す |
| **再現性** | 同じ入力で同じ問題が再現するか |

---

# テスト結果から改善へ

### 問題発見後の対応

```
【不合格ケースの分析】

1. 問題の特定
   - どのテストが不合格か
   - 何が期待と異なるか

2. 原因の分析
   - Instructions不足？
   - Knowledge不足？
   - プロンプト設計の問題？

3. 改善の実施
   - Instructions修正
   - Knowledge追加
   - 再テスト

→ Session 9-2で詳しく学ぶ
```

---

<!-- _class: lead -->
# Part 6: まとめと課題

---

# 9-1 まとめ

### テスト設計の原則

| # | 項目 | 内容 |
|---|---|---|
| 1 | **テストの目的** | 機能・安全・品質の確認 |
| 2 | **3分類** | 正常系・エッジ・異常系 |
| 3 | **評価基準** | 正確性・完全性・安全性・有用性・一貫性 |
| 4 | **設計プロセス** | 機能確認→正常系→エッジ→異常系 |
| 5 | **メタプロンプト** | テストケースもAIに生成させる |

---

# テスト設計の優先順位

### 何から始めるか

```
優先度 高
  │
  ├── 1. 安全性テスト（禁止事項・幻覚対策）
  │
  ├── 2. 正常系テスト（主要機能）
  │
  ├── 3. 異常系テスト（エラー処理）
  │
  ├── 4. エッジケーステスト（境界条件）
  │
  └── 5. 一貫性テスト（フォーマット）
  │
優先度 低
```

---

# 次の動画（9-2）の予告

### メタプロンプトでテスト＆改善

9-2では以下を学びます：

- テストケース生成メタプロンプトの実行
- テスト結果の分析
- 改善提案メタプロンプトの活用
- 改善サイクルの回し方

---

<!-- _class: lead -->
# 実習: EX-17
## テストケース生成メタプロンプト＋実行結果

詳細はテンプレート集を参照してください

---

# EX-17の概要

### 課題内容

**目的**: Session 7-8で作成したGPTsに対するテストケースを設計・実行

### 提出物

1. テストケース生成メタプロンプト
2. 生成されたテストケース（10件以上）
3. テスト実行結果
4. 振り返り

---

# EX-17のポイント

### 成功のコツ

| ポイント | 説明 |
|---|---|
| **Instructions入力** | EX-14のInstructionsを使用 |
| **10件以上** | 正常系5+エッジ3+異常系2が目安 |
| **期待結果明記** | すべてのケースに期待結果を設定 |
| **実行記録** | 入力・結果・評価を記録 |

---

# Session 9-1 まとめ

### 本動画で学んだこと

| トピック | 内容 |
|---|---|
| テストの目的 | 機能・安全・品質の確認 |
| テストケース3分類 | 正常系・エッジケース・異常系 |
| 評価基準5観点 | 正確性・完全性・安全性・有用性・一貫性 |
| 設計プロセス | 機能確認→正常系→エッジ→異常系 |
| メタプロンプト活用 | テストケースもAIに生成させる |

---

# 次回予告

### Session 9-2: メタプロンプトでテスト＆改善

- テストケース生成メタプロンプトの実行
- テスト結果の分析方法
- 改善提案メタプロンプトの活用
- 改善サイクルの回し方

---

<!-- _class: lead -->
# お疲れさまでした！

Session 9-2へ続く
