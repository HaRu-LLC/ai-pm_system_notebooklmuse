# Ver.2 設計変更依頼（3-A採用）：課題提出・ダッシュボード専用Webアプリ化

- 日付: 2026-01-03
- 対象: `workspace/20_AI_Education/Ver.2` 配下の設計ドキュメント
- 依頼者: 井戸（想定）
- 作成: AIセミナー設計責任者（AI Assistant）
- 版: v1.5
- 決定事項: **案3-Aを採用**（「LMSは作らない」／「課題提出・個人/管理者ダッシュボードのみWebアプリ化」／評価は**Gemini API**）
- 受講形態: **外部混在**（企業/個人/学生等が混在）
- 商品方針: **継続的に研修商品として運用**

---

## 1. 目的（なぜこの変更をするか）

現状のGoogle Apps一元化設計（Sites/Form/Spreadsheet/GAS）は「立ち上げが速い」一方、外部混在・継続商品では以下がボトルネックになりやすい。

- 受講者の認証・権限管理（Googleアカウント前提になりがち）
- データ分離（他受講者・他社受講者の情報漏えいリスク）
- コホート増加時の運用負荷（複製/権限/例外対応が積み上がる）

よって、**学習体験の中核となる「課題提出→評価→フィードバック→進捗可視化」だけをプロダクト化**し、継続運用とスケールに強い形へ移行する。

---

## 2. 新方針（3-Aのシステム境界）

### 2.1 Webアプリでやること（MVP）

- ログイン（外部混在に対応）
- 課題一覧（Session/必須/任意）
- 課題提出（テキスト/URL/ファイル）
- 自動評価（**Gemini API**）
- フィードバック通知（メール／Slackは任意）
- 個人ダッシュボード（進捗、評価結果、未提出）
- 管理者ダッシュボード（全体進捗、未提出、分布、CSV出力）
- 視聴チェックイン（助成金証跡）：**「動画は外部で視聴」→「アプリでチェックイン」**

### 2.2 Webアプリで「やらないこと」（LMS化しない）

- 動画配信のホスティング/DRM
- 章立て教材閲覧のリッチな学習体験（ノート/クイズ/掲示板など）
- 決済（Stripe等）は現行のままでも可

### 2.3 コンテンツ配信の位置づけ

- 動画: YouTube限定公開/Vimeo等（現状踏襲）
- 受講ポータル（コンテンツリンク集）: Google Sitesまたは静的ページ（ログイン不要でOK）
- ただし「視聴証跡」はWebアプリで取得（チェックイン）

---

## 3. 影響範囲（ドキュメント修正が必要な理由）

今回の方針転換により、以下が変わる。

- 提出手段: Google Form → **Webアプリ**
- 進捗/成績: Spreadsheet共有 → **個人ビュー/管理者ビュー（アプリ）**
- 自動評価: OpenAI API → **Gemini API**
- 認証: Google前提 → **外部混在に対応したログイン**
- 助成金用の視聴証跡: チェックインは継続（ただしForm→アプリに寄せる）

そのため、`Ver.2/docs` および `Ver.2/exercises` の「設計の正本」を更新し、矛盾がない状態にする。

---

## 4. 修正依頼サマリー（P0/P1）

### P0（開講前に必須：矛盾解消と実装の前提確定）

1. **全ドキュメントから「Google Form/Spreadsheetが正本」の前提を除去**し、Webアプリ正本に統一
2. **アクセス制御の方式をWebアプリ前提で再定義**（受講者＝自分だけ、管理者＝全体、企業別分離）
3. **視聴ログ（助成金）をアプリのチェックインに統一**（証跡の取り方・保管・監査）
4. **評価APIをGeminiに統一**（評価スキーマ、失敗時フォールバック、再評価/異議申立て）
5. **テスト計画をWebアプリ/Gemini/権限/多社運用中心に更新**

### P1（商品化に効く：運用コストと品質の底上げ）

6. データ保持/削除/監査ログの明文化（企業導入・助成金監査を想定）
7. 企業ネットワーク制約の代替手段（Slack不可/YouTube不可など）を運用設計に追加
8. KPI計測（完走率/提出率/定着率）をアプリから一貫取得できるように定義

---

## 5. ファイル別：具体的な修正依頼（詳細）

以下、「対象ファイル → 修正内容 → 完了条件（受入基準）」の形式で指示する。

---

### 5.1 `docs/OverallProjectCharter.md`（顧客向け正本）

**修正内容**
- 研修方法の記載を「Google Sites/Google Form」中心から、以下へ更新:
  - 動画視聴: YouTube/Vimeo（限定公開）
  - 課題提出/進捗/評価: **専用Webアプリ**
  - 視聴証跡: **アプリでチェックイン**（助成金対応）
- 「必要環境」から **Googleアカウント必須**を外す（外部混在のため）。代わりに「メールアドレスでの受講アカウント発行」を記載。
- KPI表現の統一:
  - 「必須課題提出率100%」を正本にする
  - 「実習提出率≥90%」のような旧表現が残っていれば削除/置換

**完了条件（受入基準）**
- 受講者が「何をどこでやるか（動画/課題/進捗）」を1枚で理解できる
- “外部混在でも参加可能” が憲章から読み取れる（Googleアカウント前提に見えない）

---

### 5.2 `docs/requirements.md`（要件定義・実装の正本）

**修正内容**
- システム方針を「Google Apps一元化」から「**Webアプリ（課題/評価/ダッシュボード）＋コンテンツは外部**」に変更
- 機能要件（FR）を追加・再定義:
  - `FR-10` ログイン/アカウント（受講者/講師/管理者）
  - `FR-11` コホート管理（期/企業/グループ）
  - `FR-12` 課題一覧/提出（必須/任意、テキスト/URL/ファイル）
  - `FR-13` 自動評価（Gemini API）＋フォールバック（再試行/手動キュー）
  - `FR-14` 個人ダッシュボード（自分の進捗・評価・未提出）
  - `FR-15` 管理者ダッシュボード（全体/フィルタ/エクスポート）
  - `FR-16` 視聴チェックイン（Session/Part単位 or Session単位の最終設計）
  - `FR-17` 受講者規約表示/同意（自動評価・異議申立て・入力禁止情報）
- アクセス制御（多社運用）の要件化:
  - 受講者は自分のデータのみ
  - 企業管理者を置く場合の範囲（自社のみ）
  - 講師/運営の範囲（全体）
- Gemini評価のI/O仕様を確定:
  - **JSONスキーマ**（必須フィールド、型、範囲）
  - プロンプトインジェクション対策（ユーザー入力隔離）
  - 失敗時フォールバック（最大リトライ、手動キュー、受講者への「評価中」通知）
- 非機能要件をWebアプリ前提で追記:
  - PIIの取り扱い、暗号化、監査ログ
  - コスト上限（月次Gemini費用、通知費用）
  - 障害時運用（手動評価、通知遅延）

**完了条件（受入基準）**
- 「Google Form/Spreadsheetが正本」の記述が要件から消える
- 実装チームが、DB/画面/API/権限を迷わず設計できる粒度になっている

---

### 5.3 `docs/curriculum_design.md`（学習設計の正本）

**修正内容**
- 提出形式/テンプレート/ツール欄を、Webアプリ前提へ統一（Google Form/Notion/Spreadsheetの固有記述は削除または「補助」に降格）
- 必須/任意の設計は維持しつつ、提出導線を「Webアプリ」へ置換
- 視聴証跡（チェックイン）の扱いを追記（助成金対応との整合）

**完了条件（受入基準）**
- 受講者の「毎週の動線（見る→やる→出す→返る）」がWebアプリ中心で矛盾なく読める

---

### 5.4 `docs/operation_sop.md`（運用の正本）

**修正内容**
- オンボーディングの「権限付与」対象をWebアプリへ置換（Sites/Spreadsheet共有は“コンテンツ閲覧用”に限定）
- 週次運用フローを更新:
  - 提出/評価/通知/未提出リマインド/異議申立てを、Webアプリ＋バックエンドの運用として整理
- 視聴ログ運用:
  - チェックインはWebアプリから行う（フォームではなく）
  - 未チェックインリマインドもアプリ起点（メール/Slack）
- 例外運用（自動評価の失敗時）:
  - v1.4 Rubricsのフォールバック（手動評価キュー）と整合させる
- 助成金保管先の統一:
  - Notionが残っていれば完全に排除し、DB/ストレージ/エクスポートへ置換

**完了条件（受入基準）**
- 2名体制（講師+運営）で「例外が起きても回る」手順が、Webアプリ前提で定義されている

---

### 5.5 `docs/test_plan.md`（品質ゲートの正本）

**修正内容**
- Webアプリ前提のテスト観点へ再構成:
  - 認証（外部混在、メール、パスワードリセット）
  - RBAC/RLS（自分以外が見えない、企業境界）
  - 課題提出（テキスト/URL/ファイル）
  - Gemini API評価（JSON検証、レート制限、コスト）
  - 通知（メール/Slack、失敗時リトライ）
  - 視聴チェックイン（証跡、未チェックイン抽出）
  - 監査ログ/エクスポート（助成金/企業監査）
- 旧「Google Apps連携」のテストは削除するか、“コンテンツ配信側（Sites）”に限定して最小化

**完了条件（受入基準）**
- 主要リスク（情報漏えい/誤採点/通知失敗/証跡欠落）をテストで検知できる

---

### 5.6 `docs/video_production_roadmap.md`（制作→運用接続）

**修正内容**
- 「Google Sites埋め込み確認」は残してOK（コンテンツポータルとして）
- 追加で、各セッションページに以下導線を必須化:
  - Webアプリの「視聴チェックイン」リンク
  - Webアプリの「必須課題」リンク
- 助成金証跡の観点で、動画概要欄/終了画面にチェックイン導線を設置する運用を明文化

**完了条件（受入基準）**
- 制作物（動画/スライド）と、運用（証跡/課題提出）が切れ目なく繋がる

---

### 5.7 `exercises/Chapter1_Rubrics.md`（提出仕様・採点仕様の正本）

**修正内容**
- Google Form設計（分岐）部分は「暫定」扱いに変更し、**Webアプリ提出UIの仕様**に置換
  - 入力項目（必須/任意）
  - 添付（URL/ファイル）の取り扱い
  - 送信後の状態（評価中→完了→通知）
- LLM評価仕様を **Gemini API** に置換（モデル名、レート、コスト想定）
- JSON専用スキーマは維持しつつ、`docs/requirements.md` と **完全一致**させる
- フォールバック（パース失敗/必須欠落/再試行/手動キュー）の設計は維持（MVPに必須）

**完了条件（受入基準）**
- “実装者がそのままAPI契約として使える”レベルの提出I/F・評価I/Fになっている

---

## 6. 新規追加を推奨するドキュメント（P0）

本方針ではWebアプリが中心になるため、追加の正本が必要。

- `docs/app_spec.md`（新規）  
  画面一覧（受講者/管理者）、状態遷移（未提出→提出→評価中→評価完了）、通知、エラーハンドリング
- `docs/db_schema.md`（新規）  
  テーブル設計（users/tenants/cohorts/sessions/assignments/submissions/evaluations/view_checkins/notifications）
- `docs/api_spec.md`（新規）  
  提出API、評価実行API、個人/管理者取得API、監査・エクスポートAPI

---

## 7. 受入基準（今回変更のDone定義）

1. 外部混在でも、受講者が**Googleアカウント無し**で受講可能（ログイン成立）
2. 個人ダッシュボードで、**自分以外の情報が一切見えない**（多社境界も含む）
3. 課題提出→Gemini評価→JSON保存→通知が、**エラー含めて**運用できる（フォールバック動作）
4. 助成金用の視聴証跡が、**取得・保管・エクスポート**できる

---

## 8. 要確認事項（最大3点）

1. 受講者ログインは「メール+パスワード」でよいか、企業導入向けにSSO（SAML/OIDC）を早期に要求するか
2. 視聴証跡は「セッション1回」か「4パート各1回」か（助成金要件に合わせて最小化したい）
3. 企業導入で「Slack通知不可」のケースを標準で想定するか（通知はメールのみを正にするか）

