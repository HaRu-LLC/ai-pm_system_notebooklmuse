# 開発ロードマップ

- プロジェクト名: AIポリテラシー育成プログラム Ver.2
- 作成日: 2026-01-05
- 版: v1.0
- 関連文書: app_spec.md (v1.1), api_spec.md (v1.1), db_schema.md (v1.1), test_plan.md (v2.1)

---

## 1. 概要

### 1.1 開発目標

| 項目 | 内容 |
|---|---|
| **プロダクト** | AIポリテラシー育成プログラム Ver.2 受講管理Webアプリ |
| **技術スタック** | Next.js 14+ / Supabase / PostgreSQL / Gemini API |
| **開発期間** | 12週間（6スプリント × 2週間） |
| **リリース目標** | 2026年Q1（開講2週間前にβリリース） |

### 1.2 開発チーム構成

| 役割 | 担当 | 責任範囲 |
|---|---|---|
| プログラムマネージャー | AI-PgM | 全体統括、スケジュール管理、品質保証 |
| 業務責任者 | 井戸 | 要件承認、UAT、最終判断 |
| フロントエンド開発 | TBD | UI実装、状態管理 |
| バックエンド開発 | TBD | API実装、DB設計 |
| インフラ担当 | TBD | CI/CD、デプロイ、監視 |

---

## 2. スプリント計画

### 2.1 スプリント概要

```
Sprint 1-2: 基盤構築・認証
Sprint 3-4: コア機能（セッション・課題・提出）
Sprint 5:   Gemini API統合・評価機能
Sprint 6:   仕上げ・テスト・リリース準備
```

### 2.2 Sprint 1（Week 1-2）: プロジェクト基盤

**目標**: 開発環境構築、認証基盤、DBスキーマ

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 1.1 | Next.js プロジェクト初期化 | `/src` 構造 | FE | 4 |
| 1.2 | Supabase プロジェクト作成 | DB接続確認 | BE | 2 |
| 1.3 | DBスキーマ実装（マイグレーション） | 全テーブル作成 | BE | 8 |
| 1.4 | RLSポリシー実装 | セキュリティ確保 | BE | 6 |
| 1.5 | 認証機能（ログイン/ログアウト） | 動作確認 | FE/BE | 12 |
| 1.6 | 招待・登録フロー | メール送信含む | FE/BE | 8 |
| 1.7 | CI/CD パイプライン構築 | GitHub Actions | Infra | 6 |

**スプリントゴール**:
- 開発環境でログイン・ログアウトが動作する
- DBスキーマが全て適用されている
- PRマージ時に自動テスト・デプロイが動作する

---

### 2.3 Sprint 2（Week 3-4）: ユーザー管理・ダッシュボード

**目標**: ユーザー管理機能、受講者ダッシュボード

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 2.1 | パスワードリセット機能 | メールフロー | FE/BE | 6 |
| 2.2 | プロフィール管理 | 編集画面 | FE/BE | 4 |
| 2.3 | 受講者ダッシュボード | 進捗表示 | FE | 12 |
| 2.4 | 管理者：受講者一覧 | 一覧・検索 | FE/BE | 8 |
| 2.5 | 管理者：受講者招待 | 招待フロー | FE/BE | 6 |
| 2.6 | RBAC実装（ミドルウェア） | 権限制御 | BE | 6 |

**スプリントゴール**:
- 受講者が自分のダッシュボードを確認できる
- 管理者が受講者を招待・管理できる
- 権限に応じたアクセス制御が機能する

---

### 2.4 Sprint 3（Week 5-6）: セッション・動画視聴

**目標**: セッション管理、動画視聴チェックイン機能

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 3.1 | セッション一覧API/UI | Phase別表示 | FE/BE | 8 |
| 3.2 | セッション詳細画面 | 2パート動画表示 | FE | 10 |
| 3.3 | 動画埋め込み（YouTube） | プレイヤー実装 | FE | 4 |
| 3.4 | 視聴チェックイン機能 | ボタン・API | FE/BE | 8 |
| 3.5 | 視聴ログ記録・表示 | DB記録・履歴 | BE | 4 |
| 3.6 | 進捗計算ロジック | viewing_progress | BE | 4 |
| 3.7 | セッションマスターデータ投入 | 12セッション分 | BE | 4 |

**スプリントゴール**:
- 受講者が動画を視聴し、チェックインできる
- ダッシュボードに視聴進捗が反映される
- 2パート構成が正しく表示される

---

### 2.5 Sprint 4（Week 7-8）: 課題・提出機能

**目標**: 課題表示、提出、下書き保存機能

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 4.1 | 課題一覧API/UI | 必須/任意フィルタ | FE/BE | 8 |
| 4.2 | 課題詳細画面 | ルーブリック表示 | FE | 6 |
| 4.3 | 下書き保存機能 | 自動保存 | FE/BE | 6 |
| 4.4 | 課題提出機能 | テキスト+ファイル | FE/BE | 10 |
| 4.5 | 提出物一覧・詳細 | 履歴表示 | FE/BE | 6 |
| 4.6 | ファイルアップロード | Supabase Storage | BE | 6 |
| 4.7 | 課題マスターデータ投入 | 24課題分 | BE | 4 |

**スプリントゴール**:
- 受講者が課題を閲覧・提出できる
- 必須/任意の区別が明確に表示される
- 下書き保存が機能する

---

### 2.6 Sprint 5（Week 9-10）: Gemini API評価・通知

**目標**: LLM自動評価、評価結果表示、メール通知

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 5.1 | Gemini API統合 | API呼び出し | BE | 8 |
| 5.2 | 評価プロンプト実装 | Phase別対応 | BE | 12 |
| 5.3 | JSON応答パース | バリデーション | BE | 6 |
| 5.4 | 評価結果DB記録 | evaluations保存 | BE | 4 |
| 5.5 | 評価結果表示UI | スコア・フィードバック | FE | 8 |
| 5.6 | リトライ・フォールバック | エラー処理 | BE | 6 |
| 5.7 | メール通知実装 | 評価完了通知 | BE | 6 |
| 5.8 | 手動評価キュー | 管理者画面 | FE/BE | 8 |

**スプリントゴール**:
- 課題提出後、自動的にGemini API評価が実行される
- 評価結果がダッシュボードに表示される
- API障害時に手動評価に切り替えられる

---

### 2.7 Sprint 6（Week 11-12）: 仕上げ・リリース準備

**目標**: 修了判定、レポート、テスト、本番デプロイ

| # | タスク | 成果物 | 担当 | 見積(h) |
|---|---|---|---|---|
| 6.1 | 修了状態確認API/UI | 修了要件表示 | FE/BE | 6 |
| 6.2 | 修了証PDF生成 | ダウンロード機能 | BE | 8 |
| 6.3 | 進捗レポートCSV出力 | 管理者機能 | BE | 4 |
| 6.4 | リマインダーメール | 未視聴/未提出通知 | BE | 4 |
| 6.5 | E2Eテスト実装 | Playwright | QA | 12 |
| 6.6 | パフォーマンステスト | 負荷テスト | QA | 6 |
| 6.7 | セキュリティレビュー | 脆弱性チェック | QA | 6 |
| 6.8 | 本番環境デプロイ | Vercel本番 | Infra | 4 |
| 6.9 | パイロットテスト実施 | Session1-2体験 | QA | 8 |

**スプリントゴール**:
- 全機能が本番環境で動作する
- テスト計画書のP0テストが全てPass
- パイロットテストで重大問題なし

---

## 3. マイルストーン

| マイルストーン | 目標日 | 完了基準 | 依存 |
|---|---|---|---|
| **M1: 開発環境Ready** | Sprint 1完了 | ログイン動作、CI/CD稼働 | - |
| **M2: 認証・管理機能** | Sprint 2完了 | RBAC動作、ダッシュボード表示 | M1 |
| **M3: 学習機能** | Sprint 4完了 | 動画視聴、課題提出が動作 | M2 |
| **M4: 評価機能** | Sprint 5完了 | Gemini API評価が動作 | M3 |
| **M5: βリリース** | Sprint 6 Week11 | 本番デプロイ、パイロット開始 | M4 |
| **M6: 正式リリース** | Sprint 6 Week12 | 開講準備完了 | M5 |

---

## 4. 技術スタック詳細

### 4.1 フロントエンド

| 技術 | バージョン | 用途 |
|---|---|---|
| Next.js | 14.x | フレームワーク（App Router） |
| React | 18.x | UI構築 |
| TypeScript | 5.x | 型安全 |
| Tailwind CSS | 3.x | スタイリング |
| shadcn/ui | latest | UIコンポーネント |
| React Hook Form | 7.x | フォーム管理 |
| Zod | 3.x | バリデーション |
| SWR / TanStack Query | 2.x | データフェッチ |

### 4.2 バックエンド

| 技術 | バージョン | 用途 |
|---|---|---|
| Supabase | latest | BaaS（認証・DB・Storage） |
| PostgreSQL | 15+ | データベース |
| Supabase Auth | - | 認証・JWT |
| Supabase Storage | - | ファイルストレージ |
| Edge Functions | - | サーバーレス関数 |

### 4.3 外部サービス

| サービス | 用途 | API |
|---|---|---|
| Gemini API | LLM評価 | gemini-1.5-flash |
| Resend / SendGrid | メール送信 | SMTP API |
| YouTube | 動画ホスティング | 埋め込みのみ |
| Stripe | 決済（将来） | Checkout |

### 4.4 インフラ・DevOps

| 技術 | 用途 |
|---|---|
| Vercel | ホスティング・CDN |
| GitHub Actions | CI/CD |
| Sentry | エラー監視 |
| Vercel Analytics | パフォーマンス監視 |

---

## 5. リスク管理

### 5.1 技術リスク

| リスク | 影響 | 確率 | 対策 |
|---|---|---|---|
| Gemini API応答遅延 | 評価遅延 | 中 | タイムアウト設定、手動フォールバック |
| Gemini API出力不正 | 評価失敗 | 中 | Structured Output、バリデーション |
| Supabase RLS設定ミス | データ漏洩 | 低 | テスト自動化、レビュー必須 |
| 動画再生問題（YouTube） | 学習阻害 | 低 | 代替プレイヤー検討 |

### 5.2 スケジュールリスク

| リスク | 影響 | 確率 | 対策 |
|---|---|---|---|
| 開発リソース不足 | 遅延 | 中 | 優先度によるスコープ調整 |
| 要件変更 | 手戻り | 中 | 変更管理プロセス、スプリントレビュー |
| テスト工数超過 | リリース遅延 | 低 | テスト自動化、早期テスト開始 |

---

## 6. 品質基準

### 6.1 コード品質

| 項目 | 基準 |
|---|---|
| TypeScript | strict モード有効 |
| ESLint | エラー0件でマージ可 |
| テストカバレッジ | 80%以上（重要パス） |
| コードレビュー | 1名以上の承認必須 |

### 6.2 パフォーマンス

| 項目 | 基準 |
|---|---|
| ページロード | 3秒以内（3G回線） |
| API応答 | 500ms以内（95パーセンタイル） |
| Gemini評価 | 30秒以内 |
| 同時ユーザー | 50人以上対応 |

### 6.3 セキュリティ

| 項目 | 基準 |
|---|---|
| 認証 | JWT有効期限7日、リフレッシュ対応 |
| HTTPS | 全通信暗号化 |
| RLS | 全テーブルで有効化 |
| 入力検証 | サーバーサイドで必須 |

---

## 7. リリース判定基準

### 7.1 Go/No-Go チェックリスト

| # | 項目 | 必須 | 確認者 |
|---|---|---|---|
| 1 | P0テスト全件Pass | 必須 | QA |
| 2 | P1テスト90%以上Pass | 必須 | QA |
| 3 | Critical/High不具合0件 | 必須 | QA |
| 4 | パイロットテスト完了 | 必須 | 井戸 |
| 5 | セキュリティレビュー完了 | 必須 | Infra |
| 6 | 本番環境動作確認 | 必須 | AI-PgM |
| 7 | ドキュメント更新 | 必須 | AI-PgM |
| 8 | ロールバック手順確認 | 必須 | Infra |

### 7.2 ロールバック基準

| 条件 | アクション |
|---|---|
| ログイン不可 | 即時ロールバック |
| 課題提出不可 | 即時ロールバック |
| データ損失リスク | 即時ロールバック |
| UI表示崩れ | ホットフィックス対応 |

---

## 8. 変更履歴

| バージョン | 日付 | 変更内容 |
|---|---|---|
| v1.0 | 2026-01-05 | 初版作成 |

---

## 承認

| 役割 | 氏名 | 承認日 |
|---|---|---|
| プログラムマネージャー | AI-PgM | 2026-01-05 |
| 業務責任者 | 井戸 | - |
