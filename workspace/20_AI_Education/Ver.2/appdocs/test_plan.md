# テスト計画書

- プロジェクト名: AIポリテラシー育成プログラム Ver.2
- 更新日: 2026-01-05
- 版: v2.2（最終課題カウント表現修正）
- 関連文書: requirements.md (v2.0), curriculum_design.md (v2.0), operation_sop.md (v2.0), app_spec.md (v1.1), api_spec.md (v1.1), db_schema.md (v1.1)

---

## 1. テスト概要

### 1.1 テスト目的

本テスト計画書は、AIポリテラシー育成プログラム Ver.2の品質を保証するため、以下を検証する：

1. **機能要件の充足**: requirements.mdで定義した全機能が正常に動作すること
2. **非機能要件の充足**: 性能・セキュリティ・可用性要件を満たすこと
3. **ユーザー体験**: 受講者が円滑に学習を進められること
4. **KPI達成可能性**: 設計が目標KPIを達成できる構造であること

### 1.2 テスト範囲

| 対象 | 範囲内 | 範囲外 |
|---|---|---|
| **専用Webアプリ** | ログイン・課題提出・ダッシュボード・視聴チェックイン | - |
| 動画配信 | YouTube/Vimeo埋め込み・視聴チェックイン | 動画内容の正確性（別途レビュー） |
| 実習課題 | 提出・管理機能・Gemini API自動評価 | 評価プロンプト最適化（別途チューニング） |
| ミーティング | 参加・録画機能 | 講義内容の品質 |
| 決済 | Stripe連携 | 経理処理 |
| **Gemini API連携** | LLM評価→JSON応答→DB記録 | - |
| **RBAC/RLS** | ロール別アクセス制御・データ分離 | - |

### 1.3 テストレベル

| レベル | 対象 | 担当 | 時期 |
|---|---|---|---|
| 単体テスト | 各機能 | 開発者 | 機能実装時 |
| 結合テスト | 機能間連携 | AI-PgM | 統合後 |
| システムテスト | 全体動作 | AI-PgM | 開講2週間前 |
| 受入テスト | ユーザー視点 | 井戸 | 開講1週間前 |
| パイロットテスト | 実運用 | テストユーザー | 開講直前 |

---

## 2. 機能テスト

### 2.1 動画配信機能（FR-01）

> **動画構成**: 各セッションは2パート構成（Part X-1: 理論編 約10分、Part X-2: 実践編 約10分）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-01-01 | Part 1動画再生 | 各セッションのPart 1動画を再生 | 5秒以内に再生開始 | P0 |
| FT-01-02 | Part 2動画再生 | 各セッションのPart 2動画を再生 | 5秒以内に再生開始 | P0 |
| FT-01-03 | 2パート構成表示 | セッション詳細画面を確認 | Part 1/Part 2が明確に区別表示 | P0 |
| FT-01-04 | 視聴完了記録 | 両パート視聴後にチェックイン | 視聴完了としてカウント | P0 |
| FT-01-05 | 複数デバイス | PC/スマホで視聴 | 両方で正常再生 | P1 |
| FT-01-06 | オフライン対応 | 一時的にオフライン | エラーメッセージ表示、再接続で継続 | P2 |

### 2.2 実習課題管理機能（FR-02）

> **課題構成**: 全24課題（必須12課題 + 任意12課題）
> - Session 1-11: 各2課題（必須1 + 任意1）= 22課題
> - Session 12（最終課題）: EX-23〜26の4成果物を**1課題**として扱い + 任意1課題（EX-22） = 2課題
> - **修了判定時**: 必須12課題 = Session 1-11各1課題（11課題）+ 最終課題（1課題）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-02-01 | 課題一覧表示 | 課題ページにアクセス | 全24課題が表示される（必須/任意の区別あり） | P0 |
| FT-02-02 | 必須/任意フィルタ | 必須課題のみ表示を選択 | 12必須課題のみ表示 | P0 |
| FT-02-03 | 課題詳細表示 | 各課題をクリック | 課題内容・評価基準・必須/任意ラベル表示 | P0 |
| FT-02-04 | 成果物提出 | テキストを入力して提出 | 提出完了メッセージ表示 | P0 |
| FT-02-05 | 提出確認 | 提出後に一覧確認 | 提出済みマークが表示 | P0 |
| FT-02-06 | ファイル添付提出 | ファイルをアップロードして提出 | ファイル添付で提出完了 | P1 |
| FT-02-07 | ファイル形式 | PDF/Docx/画像を提出 | 各形式で受付可能 | P1 |

### 2.3 進捗トラッキング機能（FR-03）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-03-01 | 受講者進捗表示 | 受講者がダッシュボード確認 | 視聴率・提出率が表示 | P0 |
| FT-03-02 | 管理者進捗表示 | 管理者が全受講者一覧確認 | 全員の進捗が一覧表示 | P0 |
| FT-03-03 | リアルタイム更新 | 動画視聴後にダッシュボード確認 | 即座に反映 | P1 |
| FT-03-04 | CSV出力 | 進捗データをエクスポート | CSV形式でダウンロード | P2 |

### 2.4 ミーティング機能（FR-04）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-04-01 | Zoom参加 | 招待リンクから参加 | ミーティングに接続 | P0 |
| FT-04-02 | 録画 | ミーティングを録画 | 録画ファイルが保存 | P0 |
| FT-04-03 | アーカイブ視聴 | 録画を後日視聴 | 正常再生 | P1 |
| FT-04-04 | 参加ログ | 参加者記録 | 参加者一覧が記録 | P1 |

### 2.5 チャットサポート機能（FR-05）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-05-01 | 質問投稿 | Slackで質問を投稿 | 投稿が表示される | P0 |
| FT-05-02 | 回答通知 | 講師が回答 | 受講者に通知 | P1 |
| FT-05-03 | スレッド機能 | 質問にスレッドで回答 | スレッドが正常動作 | P1 |

### 2.6 GPTs/ツール提供機能（FR-06）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-06-01 | GPTsアクセス | 共有リンクからアクセス | GPTsが起動 | P0 |
| FT-06-02 | GPTs動作 | 指定のプロンプトを入力 | 期待通りの応答 | P0 |
| FT-06-03 | 知識ベース参照 | 知識ファイル関連の質問 | 正確な回答 | P1 |

### 2.7 Webアプリ認証・アカウント管理機能（FR-10）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-07-01 | メール+パスワードログイン | 正しい認証情報でログイン | ダッシュボードに遷移 | P0 |
| FT-07-02 | ログイン失敗 | 誤ったパスワードでログイン | エラーメッセージ表示 | P0 |
| FT-07-03 | パスワードリセット | リセット申請→メール受信→新パスワード設定 | ログイン可能 | P0 |
| FT-07-04 | 初回ログイン規約同意 | 初回ログイン時 | 規約同意画面表示、同意後にダッシュボード | P0 |
| FT-07-05 | セッション管理 | ログイン後24時間経過 | 再認証を要求 | P1 |

### 2.8 Gemini API評価機能（FR-13）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-08-01 | Gemini API呼び出し | 課題提出後 | API正常呼び出し | P0 |
| FT-08-02 | JSON応答パース | LLM評価完了後 | スコア・コメント正常取得 | P0 |
| FT-08-03 | 評価結果DB記録 | LLM評価完了後 | evaluationsテーブルに記録 | P0 |
| FT-08-04 | 評価完了通知 | 評価完了後 | 受講者にメール通知 | P0 |
| FT-08-05 | 評価所要時間 | 課題提出〜通知 | 10分以内 | P0 |
| FT-08-06 | リトライ動作 | API一時障害時 | 3回まで自動リトライ | P1 |
| FT-08-07 | 障害時フォールバック | API長期障害時 | 手動評価に切り替え可能 | P1 |

### 2.9 RBAC/RLSアクセス制御機能

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-09-01 | 受講者個人ダッシュボード | 受講者がログイン後ダッシュボード表示 | 自分のデータのみ表示 | P0 |
| FT-09-02 | 他受講者データ非表示 | API直接呼び出しで他ユーザーIDを指定 | 403エラー返却 | P0 |
| FT-09-03 | 講師ダッシュボード | 講師ロールでログイン | 全受講者データ閲覧可能 | P0 |
| FT-09-04 | 管理者ダッシュボード | 管理者ロールでログイン | 全受講者データ＋ユーザー管理可能 | P0 |
| FT-09-05 | 企業管理者データ分離 | 企業管理者ロールでログイン | 自社受講者のみ閲覧可能 | P0 |
| FT-09-06 | RLS DB層検証 | SQLで他テナントデータ取得試行 | 取得不可 | P0 |

### 2.10 視聴チェックイン機能（FR-16）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-10-01 | チェックインボタン押下 | セッションページで「視聴完了」押下 | viewing_logsに記録 | P0 |
| FT-10-02 | 視聴完了判定 | セッション単位でチェックイン | 視聴完了フラグが立つ | P0 |
| FT-10-03 | 未チェックインリマインド | 週末まで未チェックイン | リマインドメール送信 | P1 |
| FT-10-04 | 重複チェックイン防止 | 同一セッションに再度チェックイン | ボタン無効化、記録は1件のみ | P1 |

### 2.11 修了要件管理機能（FR-17）

> **修了要件**: 動画視聴率100% + 必須課題提出率100% + 最終発表参加

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-11-01 | 修了状態確認API | `/completion-status` を呼び出し | 修了要件の達成状況を返却 | P0 |
| FT-11-02 | 視聴率100%判定 | 12セッション全てチェックイン | viewing_100pct = true | P0 |
| FT-11-03 | 必須課題100%判定 | 12必須課題全て提出完了 | required_exercises_100pct = true | P0 |
| FT-11-04 | 最終発表参加記録 | 最終発表に参加 | final_presentation_attended = true | P0 |
| FT-11-05 | 修了判定 | 3要件全て満たす | is_completed = true | P0 |
| FT-11-06 | 修了証ダウンロード | 修了後に証明書ダウンロード | PDF修了証が取得可能 | P1 |
| FT-11-07 | 未修了状態表示 | 要件未達成時 | 未達成項目が明確に表示 | P1 |

### 2.12 LP・募集ページ機能（FR-07）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-12-01 | LP表示 | LPにアクセス | 正常表示（PC/スマホ） | P0 |
| FT-12-02 | 申込フォーム | フォームに入力・送信 | 確認メール受信 | P0 |
| FT-12-03 | レスポンシブ | 各デバイスで表示 | 適切にレイアウト | P1 |

### 2.13 決済システム機能（FR-08）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-13-01 | テスト決済 | Stripeテストカードで決済 | 決済成功 | P0 |
| FT-13-02 | 決済完了通知 | 決済後 | 確認メール受信 | P0 |
| FT-13-03 | 決済エラー | 無効カードで決済 | エラーメッセージ表示 | P1 |
| FT-13-04 | 返金処理 | 管理画面から返金 | 返金処理完了 | P2 |

### 2.14 請求書発行機能（FR-09）

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| FT-14-01 | 請求書生成 | 企業情報入力後に生成 | PDF請求書ダウンロード | P1 |
| FT-14-02 | 請求書送付 | メールで送付 | 企業担当者に到達 | P1 |

---

## 3. 非機能テスト

### 3.1 性能テスト

| テストID | テスト項目 | 条件 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| NFT-01-01 | ページ表示速度 | 通常ネットワーク | 3秒以内 | P0 |
| NFT-01-02 | 動画再生開始 | 通常ネットワーク | 5秒以内 | P0 |
| NFT-01-03 | 同時視聴負荷 | 50ユーザー同時視聴 | 遅延なく再生 | P1 |
| NFT-01-04 | 同時ログイン | 100ユーザー同時ログイン | 正常動作 | P1 |

### 3.2 セキュリティテスト

| テストID | テスト項目 | 手順 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| NFT-02-01 | 認証バイパス | 未ログインでコンテンツURL直接アクセス | ログイン画面にリダイレクト | P0 |
| NFT-02-02 | 権限チェック | 受講者が管理者ページにアクセス | アクセス拒否 | P0 |
| NFT-02-03 | SSL確認 | 全ページのHTTPS | 有効なSSL証明書 | P0 |
| NFT-02-04 | 個人情報マスク | 他受講者の情報表示 | 自分の情報のみ表示 | P0 |
| NFT-02-05 | APIキー保護 | GAS Script Properties確認 | APIキーが外部公開されていない | P0 |
| NFT-02-06 | プロンプトインジェクション | 悪意ある入力でLLM評価 | 評価プロセスに影響なし | P1 |

### 3.3 可用性テスト

| テストID | テスト項目 | 条件 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| NFT-03-01 | サービス稼働 | 24時間モニタリング | 99%稼働 | P1 |
| NFT-03-02 | バックアップ復元 | バックアップからリストア | データ完全復元 | P1 |
| NFT-03-03 | 障害復旧 | 意図的なサービス停止後 | 4時間以内に復旧 | P2 |

### 3.4 Gemini API関連テスト

| テストID | テスト項目 | 条件 | 期待結果 | 優先度 |
|---|---|---|---|:---:|
| NFT-04-01 | API応答時間 | 課題1件評価 | 30秒以内 | P0 |
| NFT-04-02 | コスト監視 | 月間評価件数500件 | $30以内 | P1 |
| NFT-04-03 | レート制限対応 | 大量リクエスト時 | 適切に待機・リトライ | P1 |
| NFT-04-04 | JSON形式検証 | LLM応答 | 必須フィールド全て含む（score, breakdown, good_points, improvements, next_step） | P0 |
| NFT-04-05 | Structured Output検証 | Gemini response_schema使用 | 定義通りのJSON構造 | P0 |

---

## 4. ユーザー受入テスト（UAT）

### 4.1 受講者シナリオテスト

| シナリオID | シナリオ名 | テスト内容 |
|---|---|---|
| UAT-01 | 新規受講開始 | 申込→決済→アカウント発行→初回ログイン→規約同意→Session1視聴 |
| UAT-02 | 週次学習サイクル | Webアプリログイン→動画視聴→チェックイン→課題提出→Gemini評価通知受信→ダッシュボード確認 |
| UAT-03 | ミーティング参加 | 招待受信→Zoom参加→アーカイブ視聴 |
| UAT-04 | 質問対応 | メール/Slack質問投稿→回答受信→解決確認 |
| UAT-05 | GPTs活用 | GPTsアクセス→課題実施→成果物作成 |
| UAT-06 | 修了プロセス | 最終課題提出→最終発表→修了証取得 |
| UAT-07 | 個人ダッシュボード確認 | Webアプリログイン→自分の進捗確認→他受講者データ非表示確認 |

### 4.2 管理者シナリオテスト

| シナリオID | シナリオ名 | テスト内容 |
|---|---|---|
| UAT-11 | 受講者管理 | 受講者一覧確認→進捗確認→個別連絡 |
| UAT-12 | 成果物確認 | 提出一覧確認→成果物ダウンロード→フィードバック |
| UAT-13 | レポート作成 | 週次進捗レポート出力→分析 |

### 4.3 パイロットテスト

| 項目 | 内容 |
|---|---|
| 対象者 | 社内メンバー3-5名（A/B/Cタイプ各1名以上） |
| 期間 | 開講1週間前から開講日まで |
| 範囲 | Session1-2のフル体験 |
| フィードバック | アンケート＋インタビュー |
| 改善適用 | 開講前に軽微な修正を反映 |

---

## 5. テストスケジュール

| フェーズ | 期間 | 対象 | 担当 |
|---|---|---|---|
| 単体テスト | 各機能実装時 | 個別機能 | 開発者 |
| 結合テスト | 開講4週間前 | 機能間連携 | AI-PgM |
| システムテスト | 開講2週間前 | 全機能 | AI-PgM |
| セキュリティテスト | 開講2週間前 | セキュリティ要件 | AI-PgM |
| UAT（内部） | 開講1週間前 | 全シナリオ | 井戸 |
| パイロットテスト | 開講直前 | Session1-2 | テストユーザー |

---

## 6. 不具合管理

### 6.1 重要度定義

| 重要度 | 定義 | 対応期限 |
|:---:|---|---|
| Critical | サービス停止、データ損失 | 即時対応 |
| High | 主要機能が使えない | 24時間以内 |
| Medium | 機能制限あるが回避策あり | 1週間以内 |
| Low | 軽微な問題、見た目の問題 | 次回リリース |

### 6.2 不具合報告フォーマット

```markdown
## 不具合報告

- 報告ID: BUG-{連番}
- 報告日: YYYY-MM-DD
- 報告者: {Name}
- 重要度: Critical / High / Medium / Low
- テストID: {関連テストID}

### 概要
{不具合の概要}

### 再現手順
1. {Step1}
2. {Step2}
3. {Step3}

### 期待結果
{本来あるべき動作}

### 実際の結果
{発生した問題}

### スクリーンショット
{必要に応じて添付}

### 環境
- OS:
- ブラウザ:
- デバイス:
```

---

## 7. テスト完了基準

### 7.1 リリース判定基準

| 基準 | 条件 | 必須/推奨 |
|---|---|:---:|
| P0テスト | 全件Pass | 必須 |
| P1テスト | 90%以上Pass | 必須 |
| P2テスト | 80%以上Pass | 推奨 |
| Critical不具合 | 0件 | 必須 |
| High不具合 | 0件 | 必須 |
| Medium不具合 | 5件以下（回避策あり） | 推奨 |
| UAT | 全シナリオPass | 必須 |
| パイロットテスト | 重大問題なし | 必須 |

### 7.2 テスト完了報告

テスト完了時に以下を報告：

- テスト実施件数・Pass率
- 未解決不具合一覧と対応計画
- リリース判定（Go / No-Go）
- 残課題と対応方針

---

## 8. 変更履歴

| バージョン | 日付 | 変更内容 |
|---|---|---|
| v2.0 | 2026-01-03 | 初版作成（専用Webアプリ・Gemini API・RBAC観点追加） |
| v2.1 | 2026-01-05 | 2パート制対応、課題分類（必須12/任意12）、修了要件テスト追加 |
| v2.2 | 2026-01-05 | 最終課題カウント表現修正（4成果物→1課題） |

---

## 承認

| 役割 | 氏名 | 承認日 |
|---|---|---|
| プログラムマネージャー | AI-PgM | 2026-01-05 |
| 業務責任者 | 井戸 | - |
